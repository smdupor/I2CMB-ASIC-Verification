<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="CommandRefTopic" />
<meta name="DC.Title" content="when" />
<meta name="abstract" content="Instructs Questa SIM to perform actions when specified conditions are met." />
<meta name="description" content="Instructs Questa SIM to perform actions when specified conditions are met." />
<meta name="prodname" content="Questa SIM Command Reference Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-07-02" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_ref" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.4" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM Command Reference Manual" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.030,doc.type.documentation.ref,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>when</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="when" />
<meta name="attributes" content="product.version.2020.4,sort.order.030,doc.type.documentation.ref,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="syn-arg" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">when</h1>
<div class="body refbody CommandRefBody-Var1"><div class="abstract CommandRefAbstract"><span class="shortdesc">Instructs <span class="ph fmvar:ProductName">Questa SIM</span> to perform actions
when specified conditions are met. </span>
</div>
<div class="section Usages"><h2 class="title Subheading sectiontitle">Syntax</h2><div class="section UsageSet"><p class="lines UsageLine">when [[<a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb1be0691-45c6-46de-b6ab-41fb04b73102">-fast</a>] [<a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idd8ffd8b0-0d7b-47af-9007-90310ccf42c9">-id &lt;id#&gt;</a>] [<a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb5a39b01-6503-49f3-9644-53710cd5bdcc">-label &lt;label&gt;</a>] [<a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idff922a65-cb3f-4b0d-ac0e-49a4290c6b9f">-repeat</a>] <a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id55ede78b-9fdc-4c4b-9d5e-14b549d0ae7f">{&lt;when_condition_expression&gt;}</a> <a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id9212d465-493d-4252-844d-7ee82cb42706">{&lt;command&gt;}</a>] </p>
</div>
</div>
<div class="section Descriptions"><h2 class="title Subheading sectiontitle">Description</h2><p class="p">Use this command to control <span class="ph fmvar:ProductName">Questa SIM</span> activity
for one or more specified conditions. </p>
<p class="p">For example, you can use the
command to break on a signal value, or at a specific simulator time.
Use the <a class="xref fm:HeadingOnly" href="Command_Nowhen_id641fa1ec.html#id641fa1ec-0413-4dc9-a499-abed728527a6__Command_Nowhen_id641fa1ec.xml#id641fa1ec-0413-4dc9-a499-abed728527a6" title="Deactivates selected when commands.">nowhen</a> command
to deactivate when commands.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">When running in full
optimization mode, breakpoints cannot be set. Run the with +acc
arguments to enable the setting of breakpoints in the design. Refer
to “<a class="xref Link" href="../../questa_sim_user/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'Preservation of Object Visibility for Debugging', 'questa_sim_user'); return false;">Preservation of Object Visibility for Debugging</a>”
in the User’s Manual.</p>
</div>
<p class="p">The when
command uses a when_condition_expression to determine whether or
not to perform the action. Conditions can include VHDL signals and
Verilog nets and registers. The when_condition_expression uses a
simple restricted language, not related to Tcl, which permits only
the operators listed in <a class="xref fm:Table" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id682b0689-42b9-4a7b-bd8f-40245feec1f2">Table 1</a>, and operands that can
be HDL object names, signame'event, or constants. <span class="ph fmvar:ProductName">Questa SIM</span> evaluates the condition every
time any object in the condition changes, hence the restrictions. </p>
<p class="p">The following
items can affect your use of the when command:</p>
<ul class="ul"><li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id66662581-4cb1-4f47-84c6-6473e81d6e93"><p class="p">The when
command creates the equivalent of a VHDL process or a Verilog always
block. It does not work like a looping construct you might find
in other languages such as C.</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id16447737-eed2-4443-912d-bee5b76d4ca6"><p class="p">You cannot
use virtual signals, functions, regions, types, and so forth, in
the when command. You also cannot use simulator state variables
other than $now.</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id3870cb2b-3ad9-45b5-b4b9-83d546181a41"><p class="p">You can
enter when with no arguments to list the currently active when statements
and their labels (explicit or implicit).</p>
</li>
</ul>
<div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf696cd7b-1f53-43f2-b181-6ee1bc4a5b47"><h2 class="title Subheading sectiontitle">Embedded
Commands Allowed with the -fast Argument </h2><p class="p">You
can use any Tcl command as a &lt;command&gt;, along with any of the
following vsim commands: </p>
</div>
<ul class="ul"><li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb21d5edf-23e9-44b5-9cf2-28f0ad70b27b"><p class="p">bp, bd </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idc5a65c2e-bfe2-4169-a2f7-8b1da9e10164"><p class="p">change </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__iddb179c78-7cbb-42a9-8a92-e1bb8cabeecb"><p class="p">disablebp,
enablebp </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id7480e1e0-c1a4-4bf4-b4a1-5420cdbd3871"><p class="p">echo </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id6dc916c2-25c4-4f92-a3d9-abf5e70d8a46"><p class="p">examine </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id40e80797-9616-4d18-b589-877c0c8f4f13"><p class="p">force,
noforce </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__ida10afde8-03b9-4b42-bc8c-a6fd6b3d33ca"><p class="p">log,
nolog </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id41096b58-3e84-45c4-84a8-631b5b7d846f"><p class="p">stop </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id445b73c6-9886-41b1-a2cf-81d2500ecb4f"><p class="p">when,
nowhen </p>
</li>
</ul>
<div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf92cc5a3-0f25-41af-9419-590c72cc745d"><h2 class="title Subheading sectiontitle">Embedded
Commands Not Allowed with the -fast Argument</h2></div>
<ul class="ul"><li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf3fe12c4-b49b-4c61-8ca5-60a5d6704c72"><p class="p">Any do
commands </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__ida2e80a78-a344-4c9c-a351-2fe7aff02d80"><p class="p">Any Tk
commands or widgets </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb0b47eba-d4f2-4244-812c-b46f06d78daa"><p class="p">References
to U/I state variables or tcl variables </p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id4835d889-1808-4b4f-928b-a661b682b678"><p class="p">Virtual
signals, functions, or types</p>
</li>
</ul>
<div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id9d452234-9693-4fc2-848b-bfb3d97fa7f6"><h2 class="title Subheading sectiontitle">Using
Global Tcl Variables with the -fast Argument</h2><p class="p">Embedded
commands that use global Tcl variables for passing a state between
the when command and the user interface must use the Tcl uivar command
to declare the state. For example, the variable i below is visible
in the GUI. From the command prompt, you can display it (by entering
echo $i) or modify it (for example, by entering set i 25). </p>
</div>
<pre class="pre codeblock leveled"><code>set i 10
when -fast {clk == '0'} {
	uivar i
	set i [expr {$i - 1}]
	if {$i &lt;= 0} {
		force reset 1 0, 0 250
	}
}
when -fast {reset == '0'} {
	uivar i
	set i 10
}</code></pre><div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id0d780358-4d2d-4a1a-864d-c84ef0619fb8"><h2 class="title Subheading sectiontitle">Additional
Restrictions on the -fast Argument </h2><p class="p">You
cannot access channels (such as files, pipes, sockets) that were
opened outside of the embedded command. For example:</p>
</div>
<pre class="pre codeblock leveled"><code>set fp [open mylog.txt w]
when -fast {bus} {
	puts $fp "bus change: [examine bus]"
}</code></pre><p class="p">The
channel that $fp refers to is not available in the simulator, only
in the user interface. Even use of the uivar command does not work
here because the value of $fp has no meaning in the context of the
-fast argument. </p>
<p class="p">The
following method of rewriting this example opens the channel, writes
to it, then closes it within the when command: </p>
<pre class="pre codeblock leveled"><code>
when -fast {bus} {
	set fp [open mylog.txt a]
	puts $fp "bus change: [examine bus]"
	close $fp
}</code></pre><p class="p">The
following example is a more sophisticated method of doing the same
thing:</p>
<pre class="pre codeblock leveled"><code>when -fast {$now == 0ns} {
	set fp [open mylog.txt w]
}
when -fast {bus} {
	puts $fp "bus change: [examine bus]"
}
when -fast {$now == 1000ns} {
	close $fp
}</code></pre><p class="p">Generally,
any embedded command done using the -fast argument is global to
all other commands used with the -fast argument. In the example
above, {$now == 0ns} defines Tcl processes in a way that the -fast
commands can use. These processes have the same restrictions that
when bodies have, but the advantage is speed, as a proc tends to
execute faster than code in the when body. </p>
<p class="p">It
is recommended not to use virtual signals and expressions. </p>
</div>
<div class="section Arguments"><h2 class="title Subheading sectiontitle">Arguments</h2><div class="section ArgumentSet" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id65f55199-413a-46fa-aebc-d1eb3e4c7511"><dl class="dl ArgumentList"><dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb1be0691-45c6-46de-b6ab-41fb04b73102">-fast </dt>
<dd class="dd ArgumentDescription"><p class="p">(optional)
Causes the embedded &lt;command&gt; to execute in the simulation kernel,
which provides faster execution and reduces impact on simulation runtime
performance. Limitations on using the -fast argument are described
above (in “<a class="xref fm:HeadingOnly" href="#idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf92cc5a3-0f25-41af-9419-590c72cc745d">Embedded Commands Not Allowed with the -fast Argument</a>”). The disallowed commands still
work, but they slow down the simulation. </p>
</dd>
<dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idb5a39b01-6503-49f3-9644-53710cd5bdcc">-label &lt;label&gt;</dt>
<dd class="dd ArgumentDescription"><p class="p">(optional)
Used to identify individual when commands. </p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf3231d26-0b4d-4a08-9484-b2877b659354"><p class="p Opt">&lt;label&gt;
— Associates a name or label with the specified when command, adding
a level of identification. The label can contain special characters.
You must use quotation marks (" ") or braces ({ }) to enclose any &lt;label&gt;
that contains spaces or special characters.</p>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idd8ffd8b0-0d7b-47af-9007-90310ccf42c9">-id &lt;id#&gt;</dt>
<dd class="dd ArgumentDescription"><p class="p">(optional)
Attempts to assign this id number to the when command. </p>
<ul class="ul ArgumentOptions"><li class="li ArgOption" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id154a9d45-6291-40b2-b6a7-b20e7474e7c4"><p class="p Opt">&lt;id#&gt;
— Any positive integer that is not already assigned. If the id number
you specify is already in use, <span class="ph fmvar:ProductName">Questa SIM</span> returns
an error.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">Id numbers
for when commands are assigned from the same pool as those used
for the bp command. So even if you have not specified a given id
number for a when command, that number may still be in use for a breakpoint.</p>
</div>
</li>
</ul>
</dd>
<dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idff922a65-cb3f-4b0d-ac0e-49a4290c6b9f">-repeat</dt>
<dd class="dd ArgumentDescription"><p class="p">(Limited to “when” breakpoint expressions
involving “$now”). Instructs the command to reestablish the breakpoint
after it has been triggered, so that it will fire again for the
next time period. Without this argument, expressions using $now
trigger only once.</p>
</dd>
<dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id55ede78b-9fdc-4c4b-9d5e-14b549d0ae7f">{&lt;when_condition_expression&gt;}</dt>
<dd class="dd ArgumentDescription"><p class="p">(required
if a command is specified) Specifies the conditions to be met in
order to execute the specified &lt;command&gt;. The condition is evaluated
in the simulator kernel and can be an object name, in which case
you can omit the curly braces. The command executes when the object
changes value. The condition can be an expression with these operators:</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id682b0689-42b9-4a7b-bd8f-40245feec1f2" class="table" frame="void" border="0" rules="none"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>when_condition_expression Operators</span></caption><colgroup><col style="width:1.316in" /><col style="width:0.958in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry row-nocellborder default-entry" style="vertical-align:top;" id="d148879e393"><p class="p"> Name </p>
</th>
<th class="entry row-nocellborder default-entry" style="vertical-align:top;" id="d148879e396"><p class="p">Operator </p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">equals</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">==, =</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">not equal</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">!=, /=</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">greater than</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">&gt;</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">less than</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">&lt;</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">greater than or equal</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">&gt;=</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">less than or equal</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">&lt;=</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">AND</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">&amp;&amp;, AND</p>
</td>
</tr>
<tr class="row"><td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e393 "><p class="p">OR</p>
</td>
<td class="entry nocellnorowborder default-entry" style="vertical-align:top;" headers="d148879e396 "><p class="p">||, OR</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">The operands
can be object names, signame'event, or constants. Subexpressions
in parentheses are permitted. The command executes when the expression
is evaluated as TRUE or 1.</p>
<p class="p">The formal
BNF syntax is:</p>
<pre class="pre codeblock leveled"><code>condition ::= Name | { expression }

expression ::= expression AND relation
              | expression OR relation
              | relation</code></pre><pre class="pre codeblock leveled"><code>relation ::= Name = Literal
           | Name /= Literal
           | Name ' EVENT
           | ( expression )</code></pre><pre class="pre codeblock leveled"><code>Literal ::= '&lt;char&gt;' | "&lt;bitstring&gt;" | &lt;bitstring&gt;</code></pre><p class="p">The "="
operator can occur only between a Name and a Literal; you cannot
compare the value of two signals. For example, Name = Name is not
possible.</p>
<p class="p">You can
use Tcl variables in the condition expression, but you must replace
the curly braces ({}) with double quotes (""). This works like a
macro substitution, where the Tcl variables are evaluated once,
and the result is then evaluated as the when condition. Condition
expressions are evaluated in the vsim kernel, which knows nothing
about Tcl variables, so the condition expression must be evaluated
in the GUI before it is sent to the vsim kernel. See below for an
example of using a Tcl variable.</p>
<p class="p">The "&gt;", "&lt;",
"&gt;=", and "&lt;=" operators are the standard for vector types, not
the overloaded operators in the std_logic_1164 package. This can
cause unexpected results when comparing objects that contain values
other than 1 and 0. <span class="ph fmvar:ProductName">Questa SIM</span> does
a lexical comparison (position number) for values other than 1 and
0. For example:</p>
<pre class="pre codeblock leveled"><code>0000 &lt; 1111 ## This evaluates to true
H000 &lt; 1111 ## This evaluates to false
001X &gt;= 0010 ## This also evaluates to false</code></pre></dd>
<dt class="dt ArgumentName dlterm" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id9212d465-493d-4252-844d-7ee82cb42706">{&lt;command&gt;}</dt>
<dd class="dd ArgumentDescription"><p class="p">(required
if a when expression is specified) The Tcl interpreter within the <span class="ph fmvar:ProductName">Questa SIM</span> GUI evaluates command(s)
for this argument. Any <span class="ph fmvar:ProductName">Questa SIM</span> or
Tcl command or series of commands are valid with one exception—you
cannot use the <a class="xref fm:HeadingOnly" href="Command_Run_id08533d64.html#id08533d64-2b24-44d7-be6f-8fd331a7be5d__Command_Run_id08533d64.xml#id08533d64-2b24-44d7-be6f-8fd331a7be5d" title="Advances the simulation by the specified number of timesteps.">run</a> command
with the when command. The command sequence usually contains a <a class="xref fm:HeadingOnly" href="Command_Stop_ida9b25d99.html#ida9b25d99-d930-4207-8e33-8916367f853c__Command_Stop_ida9b25d99.xml#ida9b25d99-d930-4207-8e33-8916367f853c" title="Used with the when command to stop simulation in batch files.">stop</a> command
that sets a flag to break the simulation run after completion of
the command sequence. You can use multiple-line commands.</p>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">If you
want to stop the simulation with a when command, you must use a
stop command within your when statement. DO NOT use an <a class="xref fm:HeadingOnly" href="Command_Exit_idddd23b9f.html#idddd23b9f-3c1a-4a58-99ac-eef912f04de6__Command_Exit_idddd23b9f.xml#idddd23b9f-3c1a-4a58-99ac-eef912f04de6" title="Exits the simulator and the Questa SIM application.">exit</a> command
or a quit command. The stop command acts like a breakpoint at the
time it is evaluated.</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="section Examples"><h2 class="title Subheading sectiontitle">Examples</h2><ul class="ul"><li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__ida3cdacb9-014c-4b36-9537-b991464c1138"><p class="p">The when
command below instructs the simulator to display the value of object <span class="ph FontProperty emphasis">c</span> in
binary format when there is a clock event, the clock is 1, and the
value of <span class="ph FontProperty emphasis">b</span> is 01100111.
Finally, the command tells <span class="ph fmvar:ProductName">Questa SIM</span> to
stop.</p>
<p class="lines ApplCommand leveled">when -label when1 {clk'event and clk=’1’ and b = "01100111"} {</p>
<p class="lines ApplCommand leveled">   echo "Signal c is [exa -bin c]"</p>
<p class="lines ApplCommand leveled">   stop<br />
}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id1d4d3997-9013-412c-8889-be7dcf07e012"><p class="p">The when
command below echoes the simulator time when slice [3:1] of wire
[15:0] count matches the hexadecimal value 7, and simulation time
is between 70 and 111 nanoseconds.</p>
<p class="lines ApplCommand leveled">when {$now &gt; 70ns and count(3:1) == 3'h7 &amp;&amp; $now &lt; 111ns} {</p>
<p class="lines ApplCommand leveled">   echo "count(3:1) matched 3'h7 at time " $now <br />
}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idca56a6f4-a3cc-4325-bc96-2b8f80ddd806"><p class="p">The commands
below show an example of using a Tcl variable within a when command.
Note that the curly braces ({}) have been replaced with double quotes (""). </p>
<p class="lines ApplCommand leveled">set clkb_path /tb/ps/dprb_0/udprb/ucar_reg/uint_ram/clkb;</p>
<p class="lines ApplCommand leveled">when -label when1 "$clkb_path'event and  $clkb_path ='1'" {</p>
<p class="lines ApplCommand leveled">     echo "Detected Clk edge at path $clkb_path"</p>
<p class="lines ApplCommand leveled">}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__ida8a60693-f9c2-45ce-8dbd-ca0782c491bc"><p class="p">The when
command below is labeled <span class="ph FontProperty emphasis">a</span> and
will cause <span class="ph fmvar:ProductName">Questa SIM</span> to
echo the message “b changed” whenever the value of the object <span class="ph FontProperty emphasis">b</span> changes.</p>
<p class="lines ApplCommand leveled">when -label a b {echo "b changed"}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id539c67f9-be88-42ef-bb75-aa075c79fa7c"><p class="p">The multi-line
when command below does not use a label and has two conditions.
When the conditions are met, <span class="ph fmvar:ProductName">Questa SIM</span> runs
an echo command and a stop command.</p>
<pre class="pre codeblock leveled"><code>when {b = 1
	 and c /= 0 } {
	 echo "b is 1 and c is not 0"
	 stop
}</code></pre></li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idee101593-f22c-4b24-b36f-ef6db6ef5833"><p class="p">In the example
below, for the declaration "wire [15:0] a;", the when command will
activate when the selected bits match a 7:</p>
<p class="lines ApplCommand leveled">when {a(3:1) = 3'h7} {echo "matched at time " $now}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id77058403-e31f-4ae2-b148-c24befd0ea9a"><p class="p">If you encounter
a vectored net caused by optimizing with vopt, use the 'event qualifier
to prevent the command from falsely evaluating when unrelated bits
of ‘a’ change:</p>
<p class="lines ApplCommand leveled">when {a(3:1) = 3'h7 and a(3:1)'event} {echo "matched at time " $now}</p>
</li>
<li class="li" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__ida544a97b-9c15-4d67-ab37-112ee12fb7ce"><p class="p">In the example
below, we want to sample the values of the address and data bus
on the first falling edge of clk after sstrb has gone high.</p>
<pre class="pre codeblock leveled"><code># ::strobe is our state variable
set ::strobe Zero
# This signal breakpoint only fires when sstrb changes to a '1'
when -label checkStrobe {/top/sstrb == '1'} {
	# Our state Zero condition has been met, move to state One
	set ::strobe One
	}
# This signal breakpoint fires each time clk goes to '0'
when {/top/clk == '0'} {
	if {$::strobe eq "One"} {
		# Our state One condition has been met
		# Sample the busses
		echo Sample paddr=[examine -hex /top/paddr] :: sdata=[examine -hex 
		/top/sdata]
		# reset our state variable until next rising edge of sstrb (back to
		state Zero)
		set ::strobe Zero
	}
}
</code></pre></li>
</ul>
<div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__idf82e4aec-dadc-43ce-bff6-5f423321659d"><h2 class="title Subheading sectiontitle">Ending
the simulation with the stop command</h2><p class="p">Batch mode simulations
are often structured as "run until condition X is true," rather
than "run for X time" simulations. The multi-line when command shown
below sets a done condition, and <span class="ph fmvar:ProductName">Questa SIM</span> runs
an echo command and a stop command when the condition is reached.</p>
<p class="p">The simulation
will not stop (even if a quit -f command is used) unless you enter
a stop command. To exit the simulation and quit <span class="ph fmvar:ProductName">Questa SIM</span>, use an approach like the following:</p>
<pre class="pre codeblock leveled"><code>onbreak {resume}
when {/done_condition == ’1’} {
     echo "End condition reached"
     if [batch_mode] {
          set DoneConditionReached 1
          stop 
     }
}
run 1000 us
if {$DoneConditionReached == 1} {
     quit -f
}</code></pre><p class="p">This example
stops 100ns after a signal transition:</p>
<pre class="pre codeblock leveled"><code>when {a = 1} {
  # If the 100ns delay is already set then let it go.
  if {[when -label a_100] == ""} {
    when -label a_100 { $now = 100 } {
      # delete this breakpoint then stop
      nowhen a_100
      stop
    }
  }
}</code></pre></div>
<div class="section Subsection" id="idc392c769-7f1d-4e3e-ab8d-030f0dcf7cd1__id12023fd6-6c0c-41ff-95f1-c23efd8c88fe"><h2 class="title Subheading sectiontitle">Time-based
breakpoints</h2><p class="p">You
can build time-based breakpoints into a when statement with the
following syntax.</p>
<p class="p">For absolute
time (indicated by @) use:</p>
<p class="lines ApplCommand leveled">when {$now = @1750 ns} {stop}</p>
<p class="p">You can also
use:</p>
<p class="lines ApplCommand leveled">when {errorFlag = '1' OR $now = 2 ms} {stop}</p>
<p class="p">This example
adds 2 ms to the simulation time at which the when statement is
first evaluated, then stops. The white space between the value and
time unit is required so that the time unit can to be understood
by the simulator.</p>
<p class="p">You can also
use variables, as shown in the following example:</p>
<p class="lines ApplCommand leveled">set time 1000</p>
<p class="lines ApplCommand leveled">when "\$now = $time" {stop}</p>
<p class="p">The quotes instruct
Tcl to expand the variables before calling the command. So, the
when command sees:</p>
<p class="lines ApplCommand leveled">when "$now = 1000" stop</p>
<p class="p">Note that "$now"
has the ‘$’ escaped. This prevents Tcl from expanding the variable to:</p>
<p class="lines ApplCommand leveled">when "0 = 1000" stop</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_CommandsNZ_id3dbfc077e.html" title="This chapter describes Questa SIM commands, listed alphabetically from N through Z, that you can enter either on the command line of the Main window or in a DO file.">Commands (N - Z)</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_ref"
                DocTitle = "Questa® SIM Command Reference Manual"
                PageTitle = "when"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Command_When_idc392c769.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM Command Reference Manual, v2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>