<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Loading User-supplied TCL Code Using usertcl into VRM" />
<meta name="abstract" content="In some cases, it is necessary to load user-defined TCL code into VRM (technically, into the TCL interpreter that is executing the VRM application). This TCL code can be specified in the RMDB database or in a separate file. Once specified, the code can be loaded via a command-line option or automatically at the start of the VRM run. Any TCL code so loaded becomes a global part of the VRM application. Procedures defined within the loaded code can be called from TCL-type parameter value expressions or from user-definable procedures." />
<meta name="description" content="In some cases, it is necessary to load user-defined TCL code into VRM (technically, into the TCL interpreter that is executing the VRM application). This TCL code can be specified in the RMDB database or in a separate file. Once specified, the code can be loaded via a command-line option or automatically at the start of the VRM run. Any TCL code so loaded becomes a global part of the VRM application. Procedures defined within the loaded code can be called from TCL-type parameter value expressions or from user-definable procedures." />
<meta name="prodname" content="Verification Run Manager User Guide" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-07-10" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="vrm_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® Verification Run Manager User Guide" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Loading User-supplied TCL Code Using usertcl into VRM</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Loading User-supplied TCL Code Using usertcl into VRM" />
<meta name="attributes" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Loading User-supplied TCL Code Using
usertcl into VRM</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">In some cases,
it is necessary to load user-defined TCL code into VRM (technically,
into the TCL interpreter that is executing the VRM application).
This TCL code can be specified in the RMDB database or in a separate
file. Once specified, the code can be loaded via a command-line
option or automatically at the start of the VRM run. Any TCL code
so loaded becomes a global part of the VRM application. Procedures
defined within the loaded code can be called from TCL-type parameter
value expressions or from user-definable procedures. </span>
</div>
<p class="p">If the name of a procedure defined
in the loaded TCL code matches that of a user-definable procedure
(see “<a class="xref fm:HeadingAndPage" href="MGCChap_CatalogUserDefinableUtilityProcedures_ida2c91dd7.html#ida2c91dd7-aeb0-4a36-9ec8-a452db22433a__MGCChap_CatalogUserDefinableUtilityProcedures_ida2c91dd7.xml#ida2c91dd7-aeb0-4a36-9ec8-a452db22433a" title="This chapter documents each of the user-definable procedures, and the low-level utility procedures available to the user-definable procedures.">Catalog of User-Definable and Utility Procedures</a>”), the loaded procedure definition
replaces (overrides) the default definition supplied as part of
VRM.</p>
<p class="p">Fragments of TCL code can be defined in the
RMDB database using the<span class="ph FontProperty emphasis"> usertcl</span> element.
The <span class="ph FontProperty emphasis">usertcl</span> element
must have a <span class="ph FontProperty emphasis">name </span>attribute
by which the element can be identified. An optional <span class="ph FontProperty emphasis">base</span> attribute
can be specified whose value contains the names of one or more base <span class="ph FontProperty emphasis">usertcl </span>elements.
The <span class="ph FontProperty emphasis">usertcl</span> elements
must be defined as top-level elements (that is, as child elements
of the document (<span class="ph FontProperty emphasis">rmdb</span>)
element). The contents of a <span class="ph FontProperty emphasis">usertcl</span> element
consist of a single text string that is assumed to be valid TCL
code. For example,</p>
<pre class="pre codeblock leveled"><code>&lt;usertcl name="debugmode"&gt;
proc checkDebugMode {} {
	if {$::env(DEBUG) eq "yes"} {
		echo "Debug mode enabled"
		return 1
	}
	return 0
}
&lt;/usertcl&gt;</code></pre><p class="p">The procedure in this example can then be called
from a TCL-type parameter value expression as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;parameter name="dbgopts" type="tcl"&gt;[checkDebugMode] ? "+debug" : 
			 ""&lt;/parameter&gt;</code></pre><p class="p">which is, in turn, referenced from an Action
script command:</p>
<p class="lines ApplCommand">&lt;command&gt;vsim -c (%dbgopts%)<br />
top&lt;/command&gt;</p>
<p class="p">A <span class="ph FontProperty emphasis">usertcl</span> element
can also refer to an external file rather than provide TCL content
in-line with the XML element itself. In the event a <span class="ph FontProperty emphasis">usertcl</span> element
to be loaded specifies a non-empty <span class="ph FontProperty emphasis">file</span> attribute,
the value of that attribute is treated as a path to a file containing
TCL code for that <span class="ph FontProperty emphasis">usertcl</span> element
and the contents of that file (if readable) is loaded in place of
the contents of the <span class="ph FontProperty emphasis">usertcl</span> element.
Note that the contents of the <span class="ph FontProperty emphasis">usertcl</span> element,
if any, are ignored in this case, even if the referenced file does
not exist. The file path is assumed to be either absolute or relative
to the directory from which the RMDB database is read (that is, <span class="ph filepath">RMDBDIR</span>). The <span class="ph FontProperty emphasis">file</span> attribute
is parameter-expanded so that the path-related predefined parameters
can also be used to specify the value of the <span class="ph FontProperty emphasis">file</span> attribute.
For example,</p>
<pre class="pre codeblock leveled"><code>&lt;usertcl name="debugmode" file="debugmode.tcl"&gt;
	This string is ignored and the contents of the "debugmode.tcl" file 
			is loaded instead.
&lt;/usertcl&gt;</code></pre><p class="p">The <span class="ph FontProperty emphasis">usertcl</span> element
can specify one or more base <span class="ph FontProperty emphasis">usertcl</span> elements
via the optional <span class="ph FontProperty emphasis">base</span> attribute.
If a <span class="ph FontProperty emphasis">usertcl</span> element
is loaded for any reason, any base <span class="ph FontProperty emphasis">usertcl</span> elements
to which that element refers is also loaded. The sequence in which
the base elements are loaded is the same as the sequence in which
the elements base chain would be searched for inherited data items.
In essence, the contents of the base <span class="ph FontProperty emphasis">usertcl</span> elements are
inherited by the referring element and treated as though they were
defined directly in the referring element (by loading them whenever
the referring element itself is loaded).</p>
<p class="p">In many cases, the TCL code loaded provides
callable utility functions and user-defined override procedures
that are global in nature. That is, they are intended to customize
VRM to a specific user's flow. In this case, it makes sense to load
the associated TCL code every time VRM is invoked. If a given <span class="ph FontProperty emphasis">usertcl</span> element
is to be loaded automatically at the time VRM starts up, the name(s)
of the <span class="ph FontProperty emphasis">usertcl</span> elements
to be loaded should be placed in the <span class="ph FontProperty emphasis">loadtcl</span> attribute
of the document (<span class="ph FontProperty emphasis">rmdb</span>)
element as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;rmbd loadtcl="debugmode"&gt;
	&lt;usertcl name="debugmode"&gt;
		...auto-loaded TCL code...
	&lt;/usertcl&gt;
&lt;/rmdb&gt;</code></pre><p class="p">The <span class="ph FontProperty emphasis">loadtcl</span> attribute
can contain multiple tokens, separated by spaces and/or commas.
Each token is assumed to be the name of a <span class="ph FontProperty emphasis">usertcl</span> element
defined at the top-level of the database. When VRM initializes its
internal tables (but before the execution graph is expanded), the <span class="ph FontProperty emphasis">usertcl</span> elements
listed in the <span class="ph FontProperty emphasis">loadtcl</span> attribute
of the <span class="ph FontProperty emphasis">rmdb</span> element
are loaded in the order specified in the <span class="ph FontProperty emphasis">loadtcl</span> attribute.
Any procedures defined in the auto-loaded <span class="ph FontProperty emphasis">usertcl</span> elements
can be used in the <span class="ph FontProperty emphasis">if</span>, <span class="ph FontProperty emphasis">unless</span>, <span class="ph FontProperty emphasis">repeat,</span> or <span class="ph FontProperty emphasis">foreach</span> attributes
of <span class="ph FontProperty emphasis">runnable</span> elements
used in the regression suite, since the execution graph is only
expanded after the auto-loaded TCL fragments have been loaded.</p>
<p class="p">User-supplied TCL code can also be loaded from
the command line. The -loadtcl command-line option specifies a single
TCL code fragment to be loaded. By default, the value supplied to
the -loadtcl option is assumed to be the path to a file containing
valid TCL code. If the value supplied to the -loadtcl option is
a single token preceded by an at sign (@), as in <span class="ph filepath">@debugmode</span>,
the token is assumed to be the name of a <span class="ph FontProperty emphasis">usertcl</span> element
defined in the RMDB database and, if such a <span class="ph FontProperty emphasis">usertcl</span> element
exists, it is loaded. There can be any number of -loadtcl options
specified in a single vrun command. In this case, the -loadtcl command-line options
are processed in the order in which they appear on the command line.
The -loadtcl options from the command line are processed immediately
after loading any auto-loaded <span class="ph FontProperty emphasis">usertcl</span> elements
have been loaded. In this way, it is possible to provide an alternate
definition for a given procedure and load it manually, overriding
any definition supplied within the auto-loaded <span class="ph FontProperty emphasis">usertcl</span> element.</p>
<p class="p">Since the auto-loaded <span class="ph FontProperty emphasis">usertcl</span> elements
are defined in the RMDB database, the TCL code loaded is basically
“global” to that particular database. Another RMDB database can
have a completely different set of auto-loaded TCL code fragments.</p>
<p class="p">Note that the term “loading” a TCL code fragment
means that the contents of that code fragment are passed to the
TCL interpreter for evaluation. VRM does not parse the TCL code.
It cannot warn of potential procedure overrides. It also cannot
predict whether the loaded code will complete successfully. Errors
encountered during the “loading” of a TCL code fragment are supported
as fatal errors.</p>
<p class="p">Most behavioral tweaks made to VRM via this
mechanism are global in nature. Common examples might include changing
the pass/fail check to compare an Action script's results against
a golden file (by default, the test status is read from the UCDB
file, if any) or adding code to notify a 3rd-party tool upon completion
of each Action. For these tweaks, or for user-callable procedure
definitions that do not change the behavior of VRM, auto-loading
is probably the best solution.</p>
<p class="p">Some behavioral tweaks can depend on the context
in which VRM is invoked. For example, a tweak intended to load UCDB
files into the GUI Test Browser can only be useful when VRM is run
from the Questa GUI. The preferred solution, in this case, is to
construct a single “tweak” procedure that queries mode information
supplied in a parameter or elsewhere. There can be cases, however,
where it is simply easier to provide multiple versions of the tweak code
and select one such version from the command line via the -loadtcl
command-line option. Base inheritance can also prove useful in the
case where multiple <span class="ph FontProperty emphasis">usertcl</span> elements
are selectively loaded but some user-defined procedures are common
across two or more “modes” of behavior. In this case, the code common
to multiple behavioral modes can be placed into a single <span class="ph FontProperty emphasis">usertcl</span> element
and referred to from the <span class="ph FontProperty emphasis">usertcl</span> elements
loaded for each unique behavioral mode.</p>
<p class="p">For example, consider the following configuration:</p>
<pre class="pre codeblock leveled"><code>&lt;rmdb&gt;
	&lt;usertcl name="common"&gt;
		...code needed for both modes...
	&lt;/usertcl&gt;
	&lt;usertcl name="batch" base="common"&gt;
		...code needed for batch mode...
	&lt;/usertcl&gt;
	&lt;usertcl name="gui" base="common"&gt;
		...code needed for GUI mode...
	&lt;/usertcl&gt;
	...
&lt;/rmdb&gt;</code></pre><p class="p">The user invokes vrun with the option -loadtcl
@batch when running in batch mode and with the option -loadtcl @gui
when running in GUI mode (see “<a class="xref fm:HeadingAndPage" href="MGCChap_GraphicalUserInterfaceGui_idc5635aed.html#idc5635aed-ae45-4752-99b3-27ce64035e86__MGCChap_GraphicalUserInterfaceGui_idc5635aed.xml#idc5635aed-ae45-4752-99b3-27ce64035e86" title="This chapter describes the VRM graphical user interface.">Graphical User Interface (GUI)</a>”). The GUI mode “tweaks” can
do things like load the UCDB files from completed simulations into
the UCDB Browser as they become available. The batch mode “tweaks”
can cause e-mails to be sent out upon completion of certain subsections
of the regression suite. Still, this is just a contrived example.
As has been mentioned before, it can well be easier and more clear
to create a single override procedure that would test a parameter value
or a TCL variable to determine which behavior is appropriate.</p>
<p class="p">Note that the order in which base elements
are processed is the same as the search order for inherited data
objects (such as parameters). Each base element from a list of elements specified
in a single <span class="ph FontProperty emphasis">base</span> attribute
is completely processed, including any base elements defined in
that base element, before continuing to the next base element in
the list. This is the logical outcome of the very definition of
base inheritance that treats the contents of a base element as if
it has been defined in the referring element.</p>
<p class="p">Also note that in the case where VRM is searching
for a data object (such as a parameter) matching certain properties
(such as the parameter name), the first match usually satisfies
the search and any base elements not consulted in the process will
not be consulted at all. In the case of loading <span class="ph FontProperty emphasis">usertcl</span> elements,
there is no “matching” concept. The contents of the complete set
of base <span class="ph FontProperty emphasis">usertcl</span> elements
are loaded when the referring element is loaded (in the same order
as a network of base elements would have been searched had this
been a search like operation).</p>
<p class="p">A <span class="ph FontProperty emphasis">usertcl</span> element
is always loaded by name. The <span class="ph FontProperty emphasis">name</span> attribute
is mandatory on a <span class="ph FontProperty emphasis">usertcl</span> element.
If no <span class="ph FontProperty emphasis">usertcl</span> element
corresponding to a given name is found, an error is emitted to the
VRM log output and the vrun execution is aborted. The following
rules apply to the loading process itself:</p>
<ol class="ol"><li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__idb84b7ea3-0ea8-4b07-adbf-b74a6e579539"><p class="p">The contents of all <span class="ph FontProperty emphasis">usertcl</span> elements
are loaded into a common namespace created to hold the user-definable procedure
definitions (including the default definitions provided by VRM)
in order to prevent the user-supplied TCL code from inadvertently
colliding with existing <span class="ph FontProperty emphasis">vrun=/=vish</span> code.</p>
</li>
<li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id90194d3e-e755-4654-9b59-42c2e08f9128"><p class="p">The contents of each <span class="ph FontProperty emphasis">usertcl</span> element
is loaded as an independent chunk, which means that TCL procedure
definitions cannot span multiple <span class="ph FontProperty emphasis">usertcl</span> elements.</p>
</li>
<li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id7a736089-f9fb-4bed-bbff-0187a9e8eae2"><p class="p">Errors encountered during loading are reported
in the VRM log output and the vrun execution is aborted.</p>
</li>
</ol>
<p class="p">In the event the TCL parser throws an error
during the loading of a <span class="ph FontProperty emphasis">usertcl</span> element,
there is no way for VRM to control (or even predict) the possible
side effects of the partially loaded TCL code fragment. Therefore,
on detection of such a loading error, VRM emits an error message
to its log output and aborts. The TCL error must be fixed or the
offending <span class="ph FontProperty emphasis">usertcl</span> element
not be loaded in order to continue processing.</p>
<p class="p">Note that the purpose of this functionality
is to modify aspects of VRM behavior in order to fit the user's
verification flow. For this reason, the user should consider any
overrides made via user-supplied TCL code to be global to the specific
vrun invocation (and, by inference, to a specific database). If,
for any reason, this behavior needs to be conditional within the
same vrun invocation, some form of conditional code should be included
in the TCL procedures. Various data items related to the Action
at hand, on which these conditional checks can be based, are supplied
to each user-definable procedure.</p>
<p class="p"><span class="ph FontProperty HeadingLabel">Important Note:</span> The
contents of <span class="ph FontProperty emphasis">usertcl</span> elements
and/or TCL files loaded into VRM constitute raw TCL code. While
Mentor Graphics recommend using these loaded code fragments only
for the purpose of overriding the documented user-definable procedures,
in reality these code fragments can execute any legal TCL commands
and, knowing the proper namespace keywords, can conceivably access
any global or namespace variables in VRM code or in the underlying
vish or vsim applications (vish if vrun is called from a shell command
line or vsim if vrun is executed from within a running vsim process).
In addition, while VRM attempts to catch both parsing and runtime
errors caused by the execution of the documented user-definable
procedures, there are an infinite number of runtime bugs that VRM
cannot hope to detect. For example, user-supplied code can abort
a VRM run, bypassing the end-of-execution reporting and cleanup,
simply by executing the TCL exit command. The users must exercise
the same caution writing TCL code to be loaded into VRM that they
would in writing TCL scripts to control their simulations.</p>
<div class="section Subsections"><div class="section Subsection" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id1773c117-a66a-4370-9f0d-9485731607d8"><h2 class="title Subheading sectiontitle">Loading Conditional User-defined
TCL Code</h2><p class="p">The <span class="ph FontProperty emphasis">usertcl</span> element,
like the <span class="ph FontProperty emphasis">method</span> and <span class="ph FontProperty emphasis">runnable</span> elements,
supports <span class="ph FontProperty emphasis">if</span> and <span class="ph FontProperty emphasis">unless</span> attributes
for conditional loading. The values of these attributes are parameter-expanded
and then evaluated as TCL expressions. The rules are the same as
with the other conditional elements as follows:</p>
<ul class="ul"><li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id1e696a4a-56ba-4d0f-9308-2c373a0a50b5"><p class="p">If an <span class="ph FontProperty emphasis">if</span> attribute
is specified, it must evaluate to true.</p>
</li>
<li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__ide9ac3403-9a36-41d0-bc80-6795a7baff88"><p class="p">If an <span class="ph FontProperty emphasis">unless</span> attribute
is specified, it must evaluate to false (true and false being interpreted
in the same way as with other TCL expressions).</p>
</li>
<li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id495620ed-24dc-46ba-8cd1-c34e9e5a7e34"><p class="p">If either attribute is missing, that
condition is not checked.</p>
</li>
<li class="li" id="id3943ff33-6a4e-45b3-95b3-b4a5fa96ce7b__id2bc62a7f-4de8-4851-a715-8dade597c2c9"><p class="p">If the attribute-based conditions associated
with a given <span class="ph FontProperty emphasis">usertcl</span> element
are satisfied, the code within the element is loaded. If not, the
contents of the <span class="ph FontProperty emphasis">usertcl</span> element
are ignored.</p>
</li>
</ul>
<p class="p">It is also possible to include the condition
within the TCL contents of a <span class="ph FontProperty emphasis">usertcl</span> element
as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;usertcl name="cond1"&gt;
if {$::env(MODE) eq "noisy"} {
	proc RunManager::User::ActionCompleted {userdata} {
		upvar $userdata data
		echo "ActionCompleted: '$data(ACTION)', UCDB is '$data(ucdbfile)'"
	}
}
&lt;/usertcl&gt;</code></pre><p class="p">or even within the overridden procedure itself
as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;usertcl name="cond1"&gt;
proc RunManager::User::ActionCompleted {userdata} {
	upvar $userdata data
	if {$::env(MODE) eq "noisy"} {
		echo "ActionCompleted: '$data(ACTION)', UCDB is '$data(ucdbfile)'"
	}
}
&lt;/usertcl&gt;</code></pre><p class="p">However, in the event a given <span class="ph FontProperty emphasis">usertcl</span> element
is loaded that refers to one or more base <span class="ph FontProperty emphasis">usertcl</span> elements,
the base <span class="ph FontProperty emphasis">usertcl</span> elements
are considered and loaded even if the referring <span class="ph FontProperty emphasis">usertcl</span> element
has a non-passing condition. This is somewhat counter-intuitive
but stems from the fact that <span class="ph FontProperty emphasis">usertcl</span> elements
are loaded and not searched. When a <span class="ph FontProperty emphasis">usertcl</span> element
is identified for loading (either through the auto-load mechanism,
a command-line option, or via the base inheritance chain from another loaded
element), its base elements are also eligible for loading, even
if the original element is not loaded.</p>
<p class="p">For example, consider the following RMDB database
fragment:</p>
<pre class="pre codeblock leveled"><code>&lt;rmdb loadtcl="pos posfail"&gt;
&lt;usertcl name="pos" if="1"&gt;
	...TCL code...
&lt;/usertcl&gt;
&lt;usertcl name="posfail" if="0" base="posbase"&gt;
	...TCL code...
&lt;/usertcl&gt;
&lt;usertcl name="posbase"&gt;
	...TCL code...
&lt;/usertcl&gt;
&lt;/rmdb&gt;</code></pre><p class="p">The “pos” and “posfail” <span class="ph FontProperty emphasis">usertcl</span> elements
are eligible for loading because they are named in the auto-load
list (<span class="ph FontProperty emphasis">loadtcl</span>)
in the <span class="ph FontProperty emphasis">rmdb</span> element.
The “pos” <span class="ph FontProperty emphasis">usertcl</span> element
loads normally because, even though it has a conditional attribute,
that attribute evaluates to true. The “posfail” <span class="ph FontProperty emphasis">usertcl</span> element,
on the other hand, has a conditional attribute that does not evaluate
to true. Therefore, the code contained within the “posfail” attribute
does not get loaded. However, the base <span class="ph FontProperty emphasis">usertcl</span> element
“posbase” does get loaded by virtue of being a base element of a <span class="ph FontProperty emphasis">usertcl</span> element
otherwise eligible for loading.</p>
<p class="p">Note that even though this seems counter-intuitive,
it is the exact same result one would get if the conditional check
were embedded in the TCL code itself rather than in an attribute
on the <span class="ph FontProperty emphasis">usertcl</span> element.
The reason for this behavior stems from implementation and how the
generic inheritance walker is used in conjunction with <span class="ph FontProperty emphasis">usertcl</span> elements.</p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_UserDefinableProceduresLoadingArbitraryTclCode_idd238f0d1.html" title="VRM is designed to be a versatile scripting solution for a wide variety of regression flows and users. The basic architecture of nested Groups of Tasks following the preScript, execScript, postScript execution model is, itself, already quite extensible. Support for parametrized commands within those scripts further enhances that extensibility. However, the details involved in each step of the execution process are not quite as clear-cut. There are two approaches that must be balanced against one another as follows:">User-definable Procedures and Loading of Arbitrary TCL Code</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "vrm_user"
                DocTitle = "Questa® Verification Run Manager User Guide"
                PageTitle = "Loading User-supplied TCL Code Using usertcl into VRM"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_LoadingUserSuppliedTclCodeUsingUsertclIntoVrm_id3943ff33.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® Verification Run Manager User Guide Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>