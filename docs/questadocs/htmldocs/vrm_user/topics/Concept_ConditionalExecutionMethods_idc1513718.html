<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Conditional Execution Methods" />
<meta name="abstract" content="By itself, the ability to add method elements to Runnables in order to affect subsets of the regression suite is useful but still somewhat inflexible. In many cases, there can be a legitimate reason for wanting to launch some Actions locally, some on specific machines (that is, large capacity machines), and some on server grids of various types. Compiles, for example, may need to be executed on the local machine (or on a specific remote machine) prior to launching any simulations. Simulations may need to run on a grid during overnight regressions but might also be run on the local machine for small interactive test runs during the day. Some simulations may need additional resources or may require a slightly different set of options when the job is queued. All of these things point to the need for a more flexible paradigm for specifying the command by which each Action script is launched." />
<meta name="description" content="By itself, the ability to add method elements to Runnables in order to affect subsets of the regression suite is useful but still somewhat inflexible. In many cases, there can be a legitimate reason for wanting to launch some Actions locally, some on specific machines (that is, large capacity machines), and some on server grids of various types. Compiles, for example, may need to be executed on the local machine (or on a specific remote machine) prior to launching any simulations. Simulations may need to run on a grid during overnight regressions but might also be run on the local machine for small interactive test runs during the day. Some simulations may need additional resources or may require a slightly different set of options when the job is queued. All of these things point to the need for a more flexible paradigm for specifying the command by which each Action script is launched." />
<meta name="prodname" content="Verification Run Manager User Guide" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-07-10" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="vrm_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® Verification Run Manager User Guide" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idc1513718-ddd5-4eb8-93cd-2b3d22f7050c" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Conditional Execution Methods</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Conditional Execution Methods" />
<meta name="attributes" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="idc1513718-ddd5-4eb8-93cd-2b3d22f7050c">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Conditional Execution
Methods</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">By itself,
the ability to add <span class="ph FontProperty emphasis">method</span> elements
to Runnables in order to affect subsets of the regression suite
is useful but still somewhat inflexible. In many cases, there can
be a legitimate reason for wanting to launch some Actions locally,
some on specific machines (that is, large capacity machines), and
some on server grids of various types. Compiles, for example, may
need to be executed on the local machine (or on a specific remote
machine) prior to launching any simulations. Simulations may need
to run on a grid during overnight regressions but might also be
run on the local machine for small interactive test runs during
the day. Some simulations may need additional resources or may require
a slightly different set of options when the job is queued. All
of these things point to the need for a more flexible paradigm for specifying
the command by which each Action script is launched.</span>
</div>
<p class="p">The solution is to allow various
“condition” attributes to be added to each <span class="ph FontProperty emphasis">method</span> element
and then to allow a set of these conditional <span class="ph FontProperty emphasis">method</span> elements
to be scanned for the first such element that matches the current
conditions. As mentioned before, the search follows the base/group
inheritance chains (like parameters). At each step along the search,
any <span class="ph FontProperty emphasis">method</span> elements
defined at that Runnable are checked, in document order, for a match
to the current Action. The first matching <span class="ph FontProperty emphasis">method</span> element
found defines the execution method to be used for that Action script
and the command defined therein is used to launch the Action script just
as if that were the only <span class="ph FontProperty emphasis">method</span> element
specified.</p>
<p class="p">The basic test for a conditional match uses
the same <span class="ph FontProperty emphasis">if</span> and <span class="ph FontProperty emphasis">unless</span> attributes
as for conditional execution of Runnables. The value string defined
in the <span class="ph FontProperty emphasis">if</span> and <span class="ph FontProperty emphasis">unless</span> attributes
of the <span class="ph FontProperty emphasis">method</span> element,
like their equivalents in the <span class="ph FontProperty emphasis">runnable</span> element,
are parameter-expanded and passed to the TCL interpreter for evaluation.
If either attribute is absent or empty (that is, has an empty string for
a value), the condition associated with that attribute is considered
to pass. Otherwise, if the [optional] <span class="ph FontProperty emphasis">if</span> attribute
evaluates to a “true” value and the [optional] <span class="ph FontProperty emphasis">unless</span> attribute
evaluates to a “false” value (true and false being defined as in
the TCL language), the <span class="ph FontProperty emphasis">method</span> element
is considered to be eligible for selection. If there are multiple <span class="ph FontProperty emphasis">method</span> elements
from within a given set that are eligible for selection, priority
is given to the one defined first in document order, similar to
a chain of <span class="ph FontProperty emphasis">if/elseif/else</span> blocks
in most programming languages.</p>
<p class="p">In addition, several other conditional attributes
can also be added to the <span class="ph FontProperty emphasis">method</span> element
for convenience. These conditional attributes compare fixed strings
and are neither parameter-expanded nor TCL evaluated. <a class="xref fm:Table" href="#idc1513718-ddd5-4eb8-93cd-2b3d22f7050c__id709df967-53bb-4e06-aca1-b9c8d24e036d">Table 1</a> is the set of conditional attributes. </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="idc1513718-ddd5-4eb8-93cd-2b3d22f7050c__id709df967-53bb-4e06-aca1-b9c8d24e036d" class="table" frame="border" border="1" rules="cols"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>Conditional Attributes for the method Element</span></caption><colgroup><col style="width:1.171in" /><col style="width:4.678in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d59686e215"><p class="p">Attribute</p>
</th>
<th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d59686e218"><p class="p">Required condition
for the condition attribute to evaluate to “true”</p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e215 "><p class="p">ACTION</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e218 "><p class="p">The Action script type
(preScript, execScript, and postScript) matches the value of the
action attribute.</p>
</td>
</tr>
<tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e215 "><p class="p">RUNNABLE</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e218 "><p class="p">The name of the Runnable
on whose behalf the Action script is being executed matches the
value of the runnable attribute.<a name="fnsrc_1" href="#fntarg_1"><sup>1</sup></a></p>
</td>
</tr>
<tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e215 "><p class="p">CONTEXT</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d59686e218 "><p class="p">The context chain under
which the Action is being executed matches the value of the context
attribute.<a name="fnsrc_2" href="#fntarg_2"><sup>2</sup></a></p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">These attributes are referred to as “conditional
attributes” in this document because all of these string comparisons
can also be done with a combination of parameter expansion and TCL evaluation
from within an <span class="ph FontProperty emphasis">if</span> attribute.
For example, consider the following conditional <span class="ph FontProperty emphasis">method</span> elements:</p>
<pre class="pre codeblock leveled"><code>&lt;method action="execScript"&gt;...&lt;/method&gt;
&lt;method runnable="task1"&gt;...&lt;/method&gt;</code></pre><p class="p">Since both <span class="ph FontProperty emphasis">SCRIPT</span> and <span class="ph FontProperty emphasis">RUNNABLE</span> already
exist as predefined parameters (see “<a class="xref fm:HeadingAndPage" href="Concept_PredefinedParameterUsage_iddf078ecb.html#iddf078ecb-d843-425d-8487-8e9ad7d874b5__Concept_PredefinedParameterUsage_iddf078ecb.xml#iddf078ecb-d843-425d-8487-8e9ad7d874b5" title="A small number of parameters are predefined with values equal to certain global paths or names relevant to VRM algorithm.">Predefined Parameter Usage</a>”), these conditional execution methods
are essentially shortcuts for the following equivalent element definitions:</p>
<pre class="pre codeblock leveled"><code>&lt;method if="(%SCRIPT%) eq {execScript}"&gt;...&lt;/method&gt;, and
&lt;method if="(%RUNNABLE%) eq {task1}"&gt;...&lt;/method&gt;</code></pre><p class="p">The only real difference is that the <span class="ph FontProperty emphasis">action</span> and <span class="ph FontProperty emphasis">runnable</span> attributes
are direct string comparisons, saving both the parameter expansion
and TCL evaluation overhead. And, the “conditional” syntax is a
bit easier to read.</p>
<p class="p">Any given <span class="ph FontProperty emphasis">method</span> element
can specify multiple conditions, as in the following example:</p>
<pre class="pre codeblock leveled"><code>&lt;method runnable="task1" action="execScript" if="(%mode%) eq 
		 {batch}"&gt;...&lt;/method&gt;</code></pre><p class="p">The execution method represented by this <span class="ph FontProperty emphasis">method</span> element
is eligible for selection only when an <span class="ph FontProperty emphasis">execScript</span> action
is being executed on behalf of an instance of the Runnable <span class="ph FontProperty emphasis">task1</span> and
the value of the <span class="ph FontProperty emphasis">mode</span> parameter
(from the point of view of the executing Action) is set to the string <span class="ph FontProperty emphasis">batch</span>.
By creating a series of conditional methods, in a predetermined
sequence, one can represent pretty much any level of complexity
in the selection of execution methods for running Action scripts.</p>
<p class="p">Note that while it is legal to specify multiple
condition attributes on a given <span class="ph FontProperty emphasis">method</span> element,
the XML format prohibits adding multiple attributes of the same
name to a single element. For example, it is not possible to have
a single <span class="ph FontProperty emphasis">method</span> element
with two <span class="ph FontProperty emphasis">if</span> conditions.
If this is required, an <span class="ph FontProperty emphasis">unless</span> attribute
(inverted, of course) can be used along with the <span class="ph FontProperty emphasis">if</span> attribute
or the various conditional checks can (and probably should) be combined
to form a single parameterized TCL expression. If said expression
is too complex to be represented in a one-line TCL expression, it
can also be encoded into a TCL procedure, loaded into VRM from a <span class="ph FontProperty emphasis">usertcl</span> element,
and called from within the <span class="ph FontProperty emphasis">if</span> expression.</p>
<p class="p">As a typical example, the following execution
method queues all <span class="ph FontProperty emphasis">execScript</span> Actions
to run on a grid without affecting the execution of <span class="ph FontProperty emphasis">preScript</span> or <span class="ph FontProperty emphasis">postScript</span> Actions:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="all-simulations" action="execScript"&gt;
   &lt;command&gt;qsub -V -cwd -b yes (%WRAPPER%)&lt;/command&gt;
&lt;/method&gt;</code></pre><p class="p">The following execution
method launches all Action scripts for the Runnable named <span class="ph filepath">compile</span> in
the foreground on a specific machine:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="compile-phase" runnable="compile"&gt;
	&lt;command&gt;rsh bigmachine (%WRAPPER%)&lt;/command&gt;
&lt;method&gt;</code></pre><p class="p">Note that in this example, if the Runnable
is a Group, the <span class="ph FontProperty emphasis">preScript</span> and <span class="ph FontProperty emphasis">postScript</span> Actions
associated with that Group will both use this method (assuming this
is the only method provided). If only the <span class="ph FontProperty emphasis">preScript</span> is
to be launched on the remote machine, then an additional <span class="ph FontProperty emphasis">action</span> attribute
can be added to the <span class="ph FontProperty emphasis">method</span> element
as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="compile-phase" runnable="compile" action="preScript"&gt;
	&lt;command&gt;rsh bigmachine (%WRAPPER%)&lt;/command&gt;
&lt;method&gt;</code></pre><p class="p">Note that if the <span class="ph filepath">compile</span> Runnable
is a Group, it has no <span class="ph FontProperty emphasis">execScript</span> Action,
as Groups only execute a <span class="ph FontProperty emphasis">preScript</span> and
a <span class="ph FontProperty emphasis">postScript</span>.</p>
<p class="p">It can also occur that a shared RMDB database
might be used in more than one mode under different circumstances.
For example, an interactive user might use a given database to run
a subset of tests on the user’s local machine prior to check-in
while another user might use the same database to launch the entire
suite onto a compute grid as a nightly regression run. In this case,
the recommended method would be to define multiple <span class="ph FontProperty emphasis">method</span> elements
in a list, each with a condition attribute that tests a <span class="ph FontProperty emphasis">mode</span> parameter.
The <span class="ph FontProperty emphasis">mode</span> parameter
can be supplied from the vrun command line (that is, -Gmode=grid)
or can be defined in a top-level Runnable unique to that particular
mode. The list of <span class="ph FontProperty emphasis">method</span> elements
to accomplish a global <span class="ph FontProperty emphasis">mode</span> based
execution method selection might look like the following:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="grid-mode" if="{(%mode%)} eq {grid}"&gt;
   &lt;command&gt;qsub -V -cwd -b yes (%WRAPPER%)&lt;/command&gt;
&lt;/method&gt;
&lt;method name="gui-mode" if="{(%mode%)} eq {gui}"&gt;
   &lt;command&gt;(%WRAPPER%)&lt;/command&gt;
&lt;/method&gt;</code></pre><p class="p">Since the <span class="ph FontProperty emphasis">if</span> and <span class="ph FontProperty emphasis">unless</span> attributes
are also evaluated as TCL expressions, the whole range of information
available from TCL can be used to help select the execution method.
For example, if the <span class="ph FontProperty emphasis">mode</span> from
the example above is stored in an environment variable at the time
VRM is invoked, the following <span class="ph FontProperty emphasis">method</span> elements
can be used to query that environment variable for the execution
mode:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="grid-mode" if="{$::env(VRUN_MODE)} eq {grid}"&gt;
   &lt;command&gt;qsub -V -cwd -b yes (%WRAPPER%)&lt;/command&gt;
&lt;/method&gt;
&lt;method name="gui-mode" if="{$::env(VRUN_MODE)} eq {gui}"&gt;
   &lt;command&gt;(%WRAPPER%)&lt;/command&gt;
&lt;/method&gt;</code></pre><p class="p">In a more complex situation, the <span class="ph FontProperty emphasis">mode</span> test
can be added to any number of <span class="ph FontProperty emphasis">method</span> elements
in order to filter the list of eligible execution methods to match
the circumstances under which the tests are being run. This is another
area where VRM provides a high degree of flexibility which, for
the majority of real world projects, can never be used to its full
capacity.</p>
<p class="p">Only one method is selected for each Action
script, as the Action script is only launched once. VRM will not
combine commands from multiple <span class="ph FontProperty emphasis">method</span> elements
into a single launch command, since that would be very difficult
to get right under all circumstances. For example, if a given Action script
is to be launched onto a grid but the grid submission command must
be executed on a specific machine, the combined command must be
hand crafted by the user and added to the RMDB database in a separate
(possibly conditional) <span class="ph FontProperty emphasis">method</span> element
as follows:</p>
<pre class="pre codeblock leveled"><code>&lt;method name="grid-from-remote-machine" if="..."&gt;
   &lt;command&gt;rsh grumpy 'qsub -V -cwd -b yes (%WRAPPER%)'&lt;/command&gt;
&lt;method&gt;</code></pre><p class="p">The commands used in the above examples are
intentionally simplistic. In real life, the rsh and qsub commands
would probably need additional command-line options in order to
work correctly. The sequence and interaction of these options, as
well as the need to quote embedded commands, are the primary reasons
VRM does not attempt to automatically combine multiple execution
method commands into a single launch command.</p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_ExecutionMethods_id70589e20.html" title="By default, the wrapper associated with each Action launched by VRM is executed by either vsim or vish as a child process of the initiating VRM process. The exact command used to launch this process depends on the value of the launch attribute of the element associated with the Action. For Actions whose launch attribute is set to vsim (or which do not have a launch attribute, since vsim is the default launch type), the following command is used:">Execution Methods</a></div>
</div>
</div></div>
<div class="fn"><a name="fntarg_1" href="#fnsrc_1"><sup>1</sup></a>  <span class="ph FontProperty P10"> The phrase “on behalf of” implies that the important data point is the Runnable currently under execution and not the Runnable in which the Action script (which, in the case of an execScript, can be inherited from another Runnable) is defined.</span></div><div class="fn"><a name="fntarg_2" href="#fnsrc_2"><sup>2</sup></a>  <span class="ph FontProperty P10">This matching relies on the new “partial context match” algorithm described later in this document.</span></div></div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "vrm_user"
                DocTitle = "Questa® Verification Run Manager User Guide"
                PageTitle = "Conditional Execution Methods"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_ConditionalExecutionMethods_idc1513718.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® Verification Run Manager User Guide Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>