<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="vsim Mode Wrapper" />
<meta name="abstract" content="The command sequence used in the wrapper for vsim launched commands is shown below." />
<meta name="description" content="The command sequence used in the wrapper for vsim launched commands is shown below." />
<meta name="prodname" content="Verification Run Manager User Guide" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-07-10" />
<meta name="VariantPrefix" content="none" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="none" />
<meta name="SourceHandle" content="vrm_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® Verification Run Manager User Guide" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="idb8cd4161-115a-4671-81f8-51d300b2e24b" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>vsim Mode Wrapper</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="vsim Mode Wrapper" />
<meta name="attributes" content="product.version.2020.4,doc.type.documentation.user,doc.type.documentation.ref,product.id.P10593," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="idb8cd4161-115a-4671-81f8-51d300b2e24b">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">vsim Mode Wrapper</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">The command
sequence used in the wrapper for vsim launched commands is shown
below.</span>
</div>
<pre class="pre codeblock leveled"><code>namespace eval runmgr {
	set rm_gone 0
	set rm_stat 0
	set rm_mesg {}
	proc rm_status {stat {mesg {}}} {
		variable rm_stat
		variable rm_mesg
		set rm_stat $stat
		set rm_mesg $mesg
		return
	}
	proc rm_message {mesg {stat {0}}} {
		vrun -dest &lt;port@host&gt; -send user -code $stat -message $mesg 
			 &lt;actionName&gt;
	}
	proc rm_done {} {
		variable rm_gone
		variable rm_stat
		variable rm_mesg
		if {$rm_gone} {
			puts stderr "Blocking bogus 'done' (&lt;actionName&gt;)"
		} else {
			vrun -dest &lt;port@host&gt; -send done -code $rm_stat -message 
				 $rm_mesg &lt;actionName&gt;
		}
		set rm_gone 1
	}
}
rename quit runmgr::rm_quit
proc quit {args} {
	if {[lindex $args 0] ne {-sim}} {
		transcript file {}
		runmgr::rm_quit -sim
		cd &lt;vrunDirectory&gt;
		runmgr::rm_done
	}
	eval runmgr::rm_quit $args
	puts stderr "Blocking bogus 'done' (&lt;actionName&gt;)"
}
transcript on
onbreak {resume}
onerror {runmgr::rm_status 1 {Script error}}
quietly catch {
	cd &lt;workingDirectory&gt;
	vrun -dest &lt;port@host&gt; -send start &lt;actionName&gt;
	transcript file &lt;script&gt;.log
	do &lt;script&gt;.do
}
quit -f</code></pre><p class="p">In this case, the value of <span class="ph FontProperty emphasis">actionName</span> is
the full calling path to the Action (used to identify the specific
Action instance in the graph), the value of <span class="ph FontProperty emphasis">workingDirectory</span> is
the absolute path to the working directory associated with this
Action, and the value of <span class="ph FontProperty emphasis">script</span> is
the name of the Action (<span class="ph FontProperty emphasis">preScript</span>, <span class="ph FontProperty emphasis">execScript</span>,
or <span class="ph FontProperty emphasis">postScript</span>). Redirecting
the quit command ensures that, except for catastrophic failure of
the vsim shell, the “done” event is always passed to the master
VRM process (the value of <span class="ph filepath">port@host</span> is set
to the TCP/IP port and hostname on which a socket has been opened
by the master VRM process to receive event communications).</p>
<p class="p">When a quit command is received, the wrapper
first quits any simulation that might be running and changes directories
back to the directory from which VRM was launched (indicated by <span class="ph FontProperty emphasis">vrunDirectory</span> in
the script example). The reason for this is because VRM might need
to delete the working directory for the Action under certain conditions.
That cannot be done if the simulation is still running or if the
VRM wrapper script process is still active in the working directory.</p>
<p class="p">If, during the course of execution, the
user script calls the <span class="ph FontProperty emphasis">runmgr::rm_status</span> procedure,
the integer status value and optional message string are saved off
to be returned when the script completes. In this way, errors and/or
warnings occurring within the scripts can be conveyed to the invoking
VRM to be analyzed and handled. For more details see “<a class="xref fm:HeadingAndPage" href="Contain_ScriptReturnValues_id223029b1.html#id223029b1-8c9d-4e51-8473-e975438f8f64__Contain_ScriptReturnValues_id223029b1.xml#id223029b1-8c9d-4e51-8473-e975438f8f64" title="Each Action script has a return value that indicates, at a coarse level, whether the commands contained in the script encountered any errors. This return value is communicated to the launching vrun instance for use in pass/fail analysis. This function can require some cooperation from the (user's) Action script in order to correctly communicate the status of commands contained in the Action script.">Script Return Values</a>”.</p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_ActionWrapperScriptGeneration_id77c7374f.html" title="Each Action (preScript, execScript, or postScript) is defined either in terms of a sequence of one or more commands stored in the RMDB database or as a pointer to an existing script file (said pointer also being stored in the RMDB database).">Action and Wrapper Script Generation</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "vrm_user"
                DocTitle = "Questa® Verification Run Manager User Guide"
                PageTitle = "vsim Mode Wrapper"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_VsimModeWrapper_idb8cd4161.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® Verification Run Manager User Guide Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>