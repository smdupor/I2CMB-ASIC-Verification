<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Exploring the Makefile" />
<meta name="abstract" content="A Makefile has been included with this lesson to help UNIX and Linux users compile and simulate the design, or you can run &#34;make all&#34; to kick off the whole thing all at once. There is also a clean target to help you clean up the directory should you want to start over and run again." />
<meta name="description" content="A Makefile has been included with this lesson to help UNIX and Linux users compile and simulate the design, or you can run &#34;make all&#34; to kick off the whole thing all at once. There is also a clean target to help you clean up the directory should you want to start over and run again." />
<meta name="prodname" content="Questa SIM Tutorial" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_tut" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM Tutorial" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id7a95be9e-efb5-4333-83bb-25658e55c959" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Exploring the Makefile</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Exploring the Makefile" />
<meta name="attributes" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id7a95be9e-efb5-4333-83bb-25658e55c959">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Exploring
the Makefile</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">A <span class="ph filepath">Makefile</span> has
been included with this lesson to help UNIX and Linux users compile
and simulate the design, or you can run "make all" to kick off the
whole thing all at once. There is also a clean target to help you
clean up the directory should you want to start over and run again. </span>
</div>
<div class="fig fignone" id="id7a95be9e-efb5-4333-83bb-25658e55c959__idfd41edd9-a5d0-4593-a89b-1ecac983bbee"><span class="figcap"><span class="fig--title-label">Figure 1. </span>Makefile for Compiling and Running
on UNIX or Linux Platforms</span><pre class="pre codeblock leveled"><code> <span class="ph FontProperty P10">1	worklib:
 2		vlib work
 3	
 4	compile: test.sv
 5		vlog test.sv -dpiheader dpi_types.h
 6
 7	foreign: foreign.c</span> 
<span class="ph FontProperty P10"> 8		gcc -I$(QUESTA_HOME)/include -shared -g -o foreign.so foreign.c
 9
10 foreign_32:  foreign.c</span> 
<span class="ph FontProperty P10">11		gcc -I$(QUESTA_HOME)/include -shared -fPIC -m32 -g -o foreign.so foreign.c</span> 
<span class="ph FontProperty P10">12</span> 
<span class="ph FontProperty P10">13 optimize:
14		vopt +acc test -o opt_test
15
16 foreign_windows: foreign.c</span> 
<span class="ph FontProperty P10">17		vsim -c opt_test -dpiexportobj exports
18		gcc -I$(QUESTA_HOME)/include -shared -g -o foreign.dll foreign.c eports.obj -lmtipli -L$(QUESTA_HOME)/win32
19
20	sim:
21		vsim opt_test -sv_lib foreign
22	
23	all:
24		worklib compile foreign optimize sim
25
26 all_windows:</span> 
<span class="ph FontProperty P10">27		worklib compile optimize foreign_windows sim</span> 
<span class="ph FontProperty P10">28
29	clean:
30		rm -rf work transcript vsim.wlf foreign.so foreign.dll exports.obj
31
</span> </code></pre></div>
<p class="p">The five targets in the <span class="ph filepath">Makefile</span> are: </p>
<p class="p"><span class="ph FontProperty HeadingLabel">Line 1-2 – 	</span>The <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'vlib', 'questa_sim_ref'); return false;">vlib</a> command creates the <span class="ph filepath">work</span> library
where the compiled files will be located.</p>
<p class="p"><span class="ph FontProperty HeadingLabel">Lines 4-5 – 	</span>The <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'vlog', 'questa_sim_ref'); return false;">vlog</a> command invokes the vlog compiler on the <span class="ph filepath">test.sv</span> source
file.</p>
<p class="p"><span class="ph FontProperty HeadingLabel">Lines 7-11 and 16-18 – 	</span>The
gcc command invokes the gcc C compiler on the foreign.c source file
and creates a shared object (<span class="ph filepath">foreign.so</span>)
that will be loaded during simulation. </p>
<p class="p"><span class="ph FontProperty HeadingLabel">Lines 13-14 –</span> The <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'vopt', 'questa_sim_ref'); return false;">vopt</a> command initiates optimization of the design.
The +acc option provides full visibility into the design for debugging
purposes. The -o option is required for naming the optimized design
object (in this case, <span class="ph filepath">opt_test</span>).</p>
<p class="p"><span class="ph FontProperty HeadingLabel">Lines 20 - 21 –</span> The <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'vsim', 'questa_sim_ref'); return false;">vsim</a> command invokes the simulator using the <span class="ph filepath">opt_test</span> optimized
design object. The -sv_lib option specifies the shared object to
be loaded during simulation. Without this option, the simulator
will not be able to find any imported (C) functions you have defined.</p>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_ExamineSourceFiles_id0f5d6786.html" title="Before getting started, take a look at the main design source files in order to get acquainted with the simulation flow and some of the basic requirements for DPI.">Examine the Source Files</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_tut"
                DocTitle = "Questa® SIM Tutorial"
                PageTitle = "Exploring the Makefile"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_ExploringMakefile_id7a95be9e.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM Tutorial Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>