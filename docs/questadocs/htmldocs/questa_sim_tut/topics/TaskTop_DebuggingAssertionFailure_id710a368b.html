<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="TaskTopic" />
<meta name="DC.Title" content="Debugging the Assertion Failure" />
<meta name="abstract" content="Now we can debug the assertion failure." />
<meta name="description" content="Now we can debug the assertion failure." />
<meta name="DC.subject" content="Assertions, debugging failures" />
<meta name="keywords" content="Assertions, debugging failures" />
<meta name="prodname" content="Questa SIM Tutorial" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_tut" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM Tutorial" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id710a368b-37e2-45a0-b4d1-d435a177f30f" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Debugging the Assertion Failure</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Debugging the Assertion Failure" />
<meta name="attributes" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id710a368b-37e2-45a0-b4d1-d435a177f30f">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Debugging the Assertion Failure</h1>
<div class="body taskbody TaskBody"><div class="abstract TaskAbstract"><span class="shortdesc">Now we can
debug the assertion failure.</span>
</div>
<div class="tasklabel"><h2 class="sectiontitle tasklabel">Procedure</h2></div><ol class="ol steps"><li class="li step stepexpand" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__iddd12551b-1322-4834-b6fc-0ab98b38fd85"><span class="ph cmd">View the
source code (dram_cntrl.psl ) of the failed assertion.</span><div class="itemgroup info StepInfo"><p class="p">The current
line arrow points to the failed assertion on line 24 (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id93b0be0d-2bf5-4c2c-8fda-509d88e5f529">Figure 1</a>). This assertion consists of checking
the check_refresh property, which is defined on lines 20-22. The
property states that when the refresh signal is active, then it
will wait until the memory controller state goes to IDLE. The longest
a read or write should take is 14 cycles. If the controller is already
IDLE, then the wait is 0 cycles. Once the controller is in IDLE
state, then the refresh sequence should start in the next cycle.</p>
<div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id93b0be0d-2bf5-4c2c-8fda-509d88e5f529"><span class="figcap"><span class="fig--title-label">Figure 1. </span>Source Code for Failed
Assertion</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_source.gif" /></div><br /></div>
<p class="p">The refresh_sequence
(second line of the property) is defined on line 18. The key part
of the refresh protocol is that we_n must be held high (write enable
not active) for the entire refresh cycle.</p>
</div></li>
<li class="li step stepexpand" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idd5c856c4-edce-45ac-92d6-17c0e2042ef5"><span class="ph cmd">Check the
Wave window to see if the write enable signal, we_n, was held high
through both REF1 and REF2 states.</span><ol type="a" class="ol substeps"><li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id0ddd80c6-06b7-43a9-9670-154a136faf23"><span class="ph cmd">In the Wave
window, expand assert__check_refresh to reveal all signals referenced by
the assertion.</span></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id30272b9e-3365-4177-a0ed-560a4bb2aa8f"><span class="ph cmd">Zoom and
scroll the Wave window so you can see we_n and mem_state (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id4542fe69-bb10-48bf-85b6-bf02d1accd6f">Figure 2</a>).</span><div class="itemgroup info SubStepInfo"><div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id4542fe69-bb10-48bf-85b6-bf02d1accd6f"><span class="figcap"><span class="fig--title-label">Figure 2. </span>Examining we_n With
Respect to mem_state </span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_mem_state.gif" /></div><br /></div>
<p class="p">It is easy
to see that we_n is high only during the REF1 state. It is low during
REF2 of <span class="ph filepath">mem_state</span>. </p>
<p class="p">Let’s examine
we_n further.</p>
</div></li>
</ol>
</li>
<li class="li step stepexpand" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idabffda8c-82cc-4a7c-a22a-d77490167bfd"><span class="ph cmd">Examine
we_n in the Dataflow and Source windows.</span><ol type="a" class="ol substeps"><li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id244b8b20-389f-4d9e-b6f2-0b1795d75f36"><span class="ph cmd">Open the
Dataflow window by selecting <span class="ph menucascade"><span class="ph uicontrol">View</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Dataflow</span></span> from the Main menu, then
select the Dataflow window to make sure it is active. A “Dataflow”
menu should appear in the menu bar.</span></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id0ab96d00-0c93-4494-8612-ac5b936d392b"><span class="ph cmd">Select <span class="ph menucascade"><span class="ph uicontrol">Dataflow</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Dataflow Preferences</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Options</span></span> from the menus to open
the Dataflow Options dialog box. (If the Dataflow window is undocked,
select <span class="ph menucascade"><span class="ph uicontrol">Tools</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Options</span></span> from
the Dataflow window menus.)</span></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idc741250a-0e1e-40d0-a527-074bed998c92"><span class="ph cmd">Uncheck
the <span class="ph uicontrol">Show Hierarchy</span> selection as shown in <a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id0adb7e08-4f5a-4589-b422-89455a49abf0">Figure 3</a> and click <span class="ph uicontrol">OK</span>.</span><div class="itemgroup info SubStepInfo"><div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id0adb7e08-4f5a-4589-b422-89455a49abf0"><span class="figcap"><span class="fig--title-label">Figure 3. </span>Dataflow Options
Dialog Box</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/dataflow_options_t.gif" /></div><br /></div>
</div></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id8decfa1f-9e77-4499-ab16-a2bb6a7cdb6c"><span class="ph cmd">Select the
write enable signal we_n in the Wave window.</span></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idf85ff4ab-e886-4640-917f-1a2661d36ca4"><span class="ph cmd">Select <span class="ph menucascade"><span class="ph uicontrol">Add</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">To Dataflow</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Selected
Items</span></span> from the Main menus.</span><div class="itemgroup info SubStepInfo"><p class="p">Verilog: The Dataflow window
shows that we_n is driven by the #ASSIGN#104 process, with inputs
rw and mem_state (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__idd10a02f6-a01d-4aba-bbf5-4147e2c2afe6">Figure 4</a>). The values shown in yellow are the
values for each signal at the point at which the simulation stopped:
3100 ns. We see that we_n is St0 when mem_state is REF2. As noted
above, we_n should be St1. This is the reason for the assertion
failure.</p>
<div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idd10a02f6-a01d-4aba-bbf5-4147e2c2afe6"><span class="figcap"><span class="fig--title-label">Figure 4. </span>Viewing we_n in the
Dataflow Window - Verilog</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_dataflow.gif" /></div><br /></div>
<div class="note note"><span class="notetitle">Note:</span> <p class="p">If you
see something other than the ‘St0’ value for the <span class="ph filepath">we_n</span> signal,
enter the “radix -symbolic” command at the VSIM&gt; prompt.</p>
</div>
<p class="p">VHDL: The
Dataflow window shows that we_n is driven by the process at line
61, which has inputs rw and mem_state (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id76b6e08d-a4f9-4ace-8d53-eab5662b763e">Figure 5</a>). The values shown in yellow are the values
for each signal at the point at which the simulation stopped: 3800
ns. We see that we_n has a value of 0 when mem_state is REF2. As
noted above, we_n should be 1. This is the reason for the assertion
failure.</p>
<div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id76b6e08d-a4f9-4ace-8d53-eab5662b763e"><span class="figcap"><span class="fig--title-label">Figure 5. </span>Viewing we_n in the
Dataflow Window - VHDL</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_dataflow_vhdl.gif" /></div><br /></div>
</div></li>
<li class="li substep" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__idf7d3a337-21a5-4dce-9bc7-5ea4525167db"><span class="ph cmd">Double-click
the <span class="ph uicontrol">#ASSIGN#104</span> process that drives <span class="ph filepath">we_n</span> (line_61
in VHDL) in order to display its source code in the Source window.</span><div class="itemgroup info SubStepInfo"><p class="p">Verilog:
Looking at the Source window you will see that the current line
arrow points to line 104 of the dramcon_rtl.sv file (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id6cac96c5-d14c-4ea8-bc57-757f537b9ec7">Figure 6</a>). In this line you can see that the
logic assigning we_n is wrong - it does not account for the REF2
state. </p>
<div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id6cac96c5-d14c-4ea8-bc57-757f537b9ec7"><span class="figcap"><span class="fig--title-label">Figure 6. </span>Finding the Bug in
the Source Code - Verilog</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_source_bug.gif" /></div><br /></div>
<p class="p">The code
shows that the incorrect assignment is used for the example with
the correct assignment immediately below (lines 106-107) that will
hold we_n high through both states of the refresh cycle.</p>
<p class="p">VHDL: Looking
at the Source window you can see that the current line arrow points to
line 61 of the dramcon_rtl.vhd file (<a class="xref fm:Figure" href="#id710a368b-37e2-45a0-b4d1-d435a177f30f__id284ac620-7f6d-4e6c-881c-ccb2a2ed0282">Figure 7</a>). In this line you can see that the logic
assigning we_n is wrong - it does not account for the REF2 state.
The code shows an incorrect assignment is used. The correct assignment
is shown immediately below (in line 65) – we_n is held high through
both states of the refresh cycle.</p>
<div class="fig fignone" id="id710a368b-37e2-45a0-b4d1-d435a177f30f__id284ac620-7f6d-4e6c-881c-ccb2a2ed0282"><span class="figcap"><span class="fig--title-label">Figure 7. </span>Finding the Bug in
the Source Code - VHDL</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/assertions_source_bug_vhdl.gif" /></div><br /></div>
</div></li>
</ol>
</li>
</ol>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_DebuggingPslAssertions_id3fc31f7d.html" title="Using assertions in your HDL code increases visibility into your design and improves verification productivity. Questa SIM supports Property Specification Language (PSL) assertions for use in dynamic simulation verification. These assertions are simple statements of design intent that declare design or interface assumptions.">Debugging With PSL Assertions</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_tut"
                DocTitle = "Questa® SIM Tutorial"
                PageTitle = "Debugging the Assertion Failure"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/TaskTop_DebuggingAssertionFailure_id710a368b.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM Tutorial Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>