<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="TaskTopic" />
<meta name="DC.Title" content="Using Tcl with the Simulator" />
<meta name="abstract" content="The DO files used in previous exercises contained only Questa SIM commands. However, DO files are really just Tcl scripts. This means you can include a whole variety of Tcl constructs such as procedures, conditional operators, math and trig functions, regular expressions, and so forth." />
<meta name="description" content="The DO files used in previous exercises contained only Questa SIM commands. However, DO files are really just Tcl scripts. This means you can include a whole variety of Tcl constructs such as procedures, conditional operators, math and trig functions, regular expressions, and so forth." />
<meta name="DC.subject" content="Tcl, using in the simulator" />
<meta name="keywords" content="Tcl, using in the simulator" />
<meta name="prodname" content="Questa SIM Tutorial" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_tut" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="none" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM Tutorial" />
<meta name="CSHelp" content="no" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id1d08393c-5f41-4dff-ac8f-6010465d5828" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Using Tcl with the Simulator</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Using Tcl with the Simulator" />
<meta name="attributes" content="product.version.2020.4,sort.order.040,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id1d08393c-5f41-4dff-ac8f-6010465d5828">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Using Tcl with the Simulator</h1>
<div class="body taskbody TaskBody"><div class="abstract TaskAbstract"><p class="shortdesc">The DO
files used in previous exercises contained only <span class="ph fmvar:ProductName">Questa SIM</span> commands. However, DO files
are really just Tcl scripts. This means you can include a whole
variety of Tcl constructs such as procedures, conditional operators,
math and trig functions, regular expressions, and so forth.</p>
<p class="p">In this exercise, you
create a simple Tcl script that tests for certain values on a signal
and then adds bookmarks that zoom the Wave window when that value
exists. Bookmarks allow you to save a particular zoom range and
scroll position in the Wave window.</p>
<p class="p">The Tcl script also creates
buttons in the Main window called bookmarks. </p>
</div>
<div class="tasklabel"><h2 class="sectiontitle tasklabel">Procedure</h2></div><ol class="ol steps"><li class="li step" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idb93850ed-f06e-4638-ab5c-493667221e9f"><span class="ph cmd">Create
the script.</span><ol type="a" class="ol substeps"><li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id0d9dbb42-c95f-4931-a7a4-a461ddd8d8bb"><span class="ph cmd">In a text
editor, open a new file and enter the following lines:</span><div class="itemgroup info SubStepInfo"><pre class="pre codeblock leveled"><code><span class="ph FontProperty P9">proc add_wave_zoom {stime num} {
 echo "Bookmarking wave $num"
 bookmark add wave "bk$num"  "[expr $stime - 100] [expr $stime + 50]" 0
<span class="ph"> add button "$num" [list bookmark goto wave bk$num]</span>}</span></code></pre><p class="p">These commands do the following:</p>
<ul class="ul"><li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id337abfe8-8d78-4ba2-ba8a-6b9f8fc7bd8d"><p class="p">Create
a new procedure called “add_wave_zoom” that has two arguments, stime
and num.</p>
</li>
<li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idb2ef99b7-6feb-4cd0-86cd-1077fb723ca3"><p class="p">Create
a bookmark with a zoom range from the current simulation time minus
100 time units to the current simulation time plus 50 time units.</p>
</li>
<li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id99a5b42e-f212-482c-9782-f4a0e64e94c4"><p class="p">Add a
button to the Main window that calls the bookmark.</p>
</li>
</ul>
</div></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id399aa796-01de-4034-b51d-22c623c02b1a"><span class="ph cmd">Now add
these lines to the bottom of the script:</span><div class="itemgroup info SubStepInfo"><pre class="pre codeblock leveled"><code><span class="ph FontProperty P9">add wave -r /*
when {clk'event and clk="1"} {
   echo "Count is [exa count]"
   if {[examine count]== "8'h27"} {
      add_wave_zoom $now 1
   } elseif {[examine count]== "8'h47"} {
      add_wave_zoom $now 2
   }
}</span></code></pre><p class="p"><span class="ph FontProperty P9"></span>These
commands do the following:</p>
<ul class="ul"><li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id6a28549b-4793-4a8e-98ba-face9c58a617"><p class="p">Add
all signals to the Wave window.</p>
</li>
<li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id53090b93-a3ef-4737-82d2-881d848177b2"><p class="p">Use
a <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'when', 'questa_sim_ref'); return false;">when</a> statement to identify when clk transitions
to 1.</p>
</li>
<li class="li" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idfececec4-f584-4723-8faa-ef31585d0892"><p class="p">Examine
the value of count at those transitions and add a bookmark if it
is a certain value.</p>
</li>
</ul>
</div></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idc6598ae9-13a2-4e80-ae55-61466d5059c2"><span class="ph cmd">Save the
script with the name “add_bkmrk.do” into the directory you created
in the <a class="xref fm:HeadingOnly" href="MGCChap_BasicSimulation_id0a201bc2.html#id0a201bc2-7e58-4be3-8ef5-4fcec2f9fe97__MGCChap_BasicSimulation_id0a201bc2.xml#id0a201bc2-7e58-4be3-8ef5-4fcec2f9fe97" title="In this lesson you will guide you through the basic simulation flow.">Basic Simulation</a> lesson.</span></li>
</ol>
</li>
<li class="li step" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id1be73f96-1ebd-4e09-ae24-be9b52ab6b0b"><span class="ph cmd">Load the
test_counter design unit and make sure the radix is set to binary.</span><ol type="a" class="ol substeps"><li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id7963b188-2141-4c40-8157-bc3af53ccc8c"><span class="ph cmd">Start <span class="ph fmvar:ProductName">Questa SIM</span>.</span></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idf08e6bc6-12c5-4f21-aecd-83394e65d52b"><span class="ph cmd">Select <span class="ph menucascade"><span class="ph uicontrol">File</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">Change Directory</span></span> and
change to the directory you saved the DO file to above (the directory
you created in the Basic Simulation lesson).</span></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id1a71b667-34d5-4fce-b893-548f4ba6ad1c"><span class="ph cmd">Type radix
-binary at the <span class="ph fmvar:ProductName">Questa SIM</span> &gt; prompt</span></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idaf511577-bbf4-49e1-b626-37620984794d"><span class="ph cmd">Enter
the following command at the <span class="ph fmvar:ProductName">Questa SIM</span> &gt;
prompt:</span><div class="itemgroup info SubStepInfo"><p class="lines ApplCommand">vsim testcounter_opt</p>
</div></li>
</ol>
</li>
<li class="li step" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id1bc35931-f9cb-46ab-b386-97777568b377"><span class="ph cmd">Execute
the DO file and run the design.</span><ol type="a" class="ol substeps"><li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idb59e341d-f92b-4ad8-a3c9-49a3d3b06347"><span class="ph cmd">Type do
add_bkmrk.do at the VSIM&gt; prompt.</span></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id8fe37147-9407-4b3c-9156-5fe46943a645"><span class="ph cmd">Type run
1500 ns at the VSIM&gt; prompt.</span><div class="itemgroup info SubStepInfo"><p class="p">The simulation
runs and the DO file creates two bookmarks.</p>
<p class="p">It also creates
buttons (labeled “1” and “2”) on the Main window toolbar that jump
to the bookmarks (<a class="xref fm:Figure" href="#id1d08393c-5f41-4dff-ac8f-6010465d5828__idb47eb19b-bb7d-4f92-b9a6-994d728f93d2">Figure 1</a>).</p>
<div class="fig fignone" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__idb47eb19b-bb7d-4f92-b9a6-994d728f93d2"><span class="figcap"><span class="fig--title-label">Figure 1. </span>Buttons Added to the
Main Window Toolbar</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics/main_bkmrk_btns.gif" /></div><br /></div>
</div></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id3b9cf2f7-0f30-44f9-be09-bacf680d7491"><span class="ph cmd">Click the
buttons and watch the Wave window zoom in and scroll to the time
when count is the value specified in the DO file.</span></li>
<li class="li substep" id="id1d08393c-5f41-4dff-ac8f-6010465d5828__id23381d9b-e5fb-4aea-a085-b71c9120e2e4"><span class="ph cmd">If the Wave window is docked in the Main
window make it the active window (click anywhere in the Wave window),
then select<span class="ph menucascade"><span class="ph uicontrol"> Bookmarks</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">bk1</span></span>. If the window
is undocked, select <span class="ph menucascade"><span class="ph uicontrol">Bookmarks</span><abbr title="and then"> &gt; </abbr><span class="ph uicontrol">bk1</span></span> in the Wave
window.</span><div class="itemgroup info SubStepInfo"><p class="p">Watch the
Wave window zoom in and scroll to the time when count is 8'h27.
Try the bk2 bookmark as well.</p>
</div></li>
</ol>
</li>
</ol>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_AutomatingSimulation_id70663787.html" title="Aside from executing a couple of pre-existing DO files, the previous lessons focused on using Questa SIM in interactive mode: executing single commands, one after another, through the GUI menus or Main window command line. In situations where you have repetitive tasks to complete, you can increase your productivity with DO files.">Automating Simulation</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_tut"
                DocTitle = "Questa® SIM Tutorial"
                PageTitle = "Using Tcl with the Simulator"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/TaskTop_UsingTclSimulator_id1d08393c.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM Tutorial Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>