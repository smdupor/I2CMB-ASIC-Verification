<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ContainerTopic" />
<meta name="DC.Title" content="Assertion Coding Guidelines" />
<meta name="abstract" content="Writing assertions, like writing RTL code, requires knowledge of which constructs are more efficient than others in terms of how they affect simulation performance. This section provides a few key guidelines that will help you improve simulation throughput, as well as a few key things you should avoid." />
<meta name="description" content="Writing assertions, like writing RTL code, requires knowledge of which constructs are more efficient than others in terms of how they affect simulation performance. This section provides a few key guidelines that will help you improve simulation throughput, as well as a few key things you should avoid." />
<meta name="DC.subject" content="assertions, coding guidelines, Coding, assertion guidelines, Guidelines, for coding assertions" />
<meta name="keywords" content="assertions, coding guidelines, Coding, assertion guidelines, Guidelines, for coding assertions" />
<meta name="prodname" content="Questa SIM User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM User's Manual" />
<meta name="CSHelp" content="none" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id84398069-0125-4451-8123-6062979ce451" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Assertion Coding Guidelines</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Assertion Coding Guidelines" />
<meta name="attributes" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id84398069-0125-4451-8123-6062979ce451">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Assertion Coding Guidelines</h1>
<div class="body MGCBody"><div class="abstract ContainerAbstract"><span class="shortdesc">Writing
assertions, like writing RTL code, requires knowledge of which constructs
are more efficient than others in terms of how they affect simulation
performance. This section provides a few key guidelines that will
help you improve simulation throughput, as well as a few key things
you should avoid. </span>
</div>
<p class="p">We assume a basic understanding of assertion terminology,
sequence operators, and syntax. The coding examples in the guidelines
below are written in SystemVerilog but the concepts apply equally
to PSL.</p>
<ol class="ol"><li class="li" id="id84398069-0125-4451-8123-6062979ce451__ida68d8e3a-46f5-4c22-a466-cc42f8ab2d9a"><p class="p">Keep directives simple. Create named
assertions that you then reference from the assert directive (for
example, assert check1).</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id2b1e9af1-15be-4c45-9ee8-54b9023ba6f5"><p class="p">Keep properties and sequences simple
too. Build complex assertions out of simple, short assertions/sequences.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idbbcf7e69-06d8-485c-a994-c789631355d5"><p class="p">Whenever possible, reference a single
clock. Properties referencing multiple clocks require far more simulation
time than properties referencing a single clock.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id65a33f1b-7d19-4a31-8a4f-2019b93c8759"><p class="p">Do not use implication with <span class="ph FontProperty emphasis">never</span> directives.
You will rarely get what you want if you use implication with a <span class="ph FontProperty emphasis">never</span>.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idb25aac25-c513-4a46-bf70-bb738520afb9"><p class="p">Create named sequences so you can reuse
them in multiple assertions.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idae913cbd-c420-47f3-ae77-ab0344566050"><p class="p">Be aware of “unexpected matches.” For
example, the following PSL assertion:</p>
<pre class="pre codeblock leveled"><code>assert always a-&gt;next(b-&gt;next(c));
</code></pre><p class="p">will match all of the following conditions
(as well as others):</p>
<div class="fig fignone" id="id84398069-0125-4451-8123-6062979ce451__id09842767-cda0-4bfa-88ce-958f0899d98a"><span class="figcap"><span class="fig--title-label">Figure 1. </span>Assertion Matches</span><br /><div class="imagecenter"><img class="image imagecenter fmdpi:100" src="../graphics_composites/a_assertions02a.png" /></div><br /></div>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id621bcab5-396c-44e2-8a3a-01ab4019548a"><p class="p">Avoid long or infinite time ranges.
For example, if there is an effective timeout in a sequence, make
the time range for the timeout as short as possible given the overall
functional/timing requirements of the design. Using an infinite
time range in an assertion means that it is never able to fail. </p>
<p class="p">Take the example of a simple handshake
protocol which requires an acknowledgment for every ready indication:</p>
<pre class="pre codeblock"><code>property handshake_check;
always @(posedge clk) rdy |-&gt; ##[1:$] acpt ##1 !acpt;
endproperty
assert property(handshake_check);</code></pre><p class="p">A much more simulation-efficient way
of expressing the concept of <span class="ph FontProperty emphasis">eventually</span> in
an assertion is to use the <span class="ph FontProperty emphasis">goto</span> operator
as follows:</p>
<pre class="pre codeblock"><code>property handshake_check;
	always @(posedge clk) rdy |-&gt; acpt[-&gt;1] ##1 !acpt;
endproperty
assert property(handshake_check);</code></pre><p class="p">Within a sequence, the use of large
or unbounded time range can severely impact simulation performance.
The reason for this is that a separate thread is spawned for each possibility
in the legal range. For example, the sequence,</p>
<pre class="pre codeblock leveled"><code>(a ##1 b[*1 to 8000] ##5 c ##1 d)</code></pre><p class="p">can result in 8000 separate threads
of the form:</p>
<pre class="pre codeblock"><code>(a ##1 b[*1] ##5 c ##1 d);
(a ##1 b[*2] ##5 c ##1 d);
...
(a ##1 b[*8000] ##5 c ##1 d);</code></pre></li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id48bc34a8-d702-4d6f-af5c-2a7232a17543"><p class="p">Use system functions like <span class="ph FontProperty emphasis">$rose</span> and <span class="ph FontProperty emphasis">$fell</span> to
avoid inadvertently spawning a new thread or several new threads
each cycle. In the line below,</p>
<pre class="pre codeblock leveled"><code>(!a[*0:$] ##1 a) |-&gt; b;</code></pre><p class="p">a thread will be started at every clock
edge to check if <span class="ph FontProperty emphasis">a</span> is
not true. A better way to write this is:</p>
<pre class="pre codeblock leveled"><code>$rose(a) |-&gt; b;</code></pre></li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idfea361e3-ce1c-4a4b-83a0-db559886a4e1"><p class="p">Use a qualifying condition when repetitively
checking (<span class="ph FontProperty emphasis">[-&gt;n]</span>)
for multiple occurrences of a condition in the antecedent expression
of an assertion. Often, writing assertions involves the need to
check for multiple occurrences of an expression to trigger when
additional expressions are evaluated. In the examples below, the
intent is to check for 48 occurrences (non-consecutive) of signal <span class="ph FontProperty emphasis">a</span>;
and on the 48th time signal <span class="ph FontProperty emphasis">a</span> is
true, signal <span class="ph FontProperty emphasis">b</span> is also
required to be true.</p>
<pre class="pre codeblock leveled"><code>a[-&gt;48] |-&gt; b;</code></pre><p class="p">When re-written in its equivalent form
below, the above property is extremely expensive in terms of spawning
new threads. Since a brand new thread is started each and every
cycle signal <span class="ph FontProperty emphasis">a</span> is
not true, threads grow at an nearly an exponential rate. And previously
started threads, in turn, spawn new threads each subsequent cycle
due the unbounded time range when signal <span class="ph FontProperty emphasis">a</span> is
false.</p>
<pre class="pre codeblock leveled"><code>(!a[*0:$] ##1 a)[*48] |-&gt; b;</code></pre></li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id5cc0eff6-72b3-40c9-adae-c449454e63ba"><p class="p">In general, be very careful when using
the non-consecutive (<span class="ph FontProperty emphasis">[=n]</span>)
operator, but especially on the left-hand side of an implication.
Consider the property:</p>
<pre class="pre codeblock"><code>property p3;
@(posedge clk) a ##1 d[=2] ##1 c |-&gt; ##1 e;
endproperty
assert property (p3);</code></pre><p class="p">It is easy to incorrectly interpret
this property as <span class="ph FontProperty emphasis">a</span> followed
by 2 non-consecutive occurrences of <span class="ph FontProperty emphasis">d</span> followed
at least 1 cycle later by <span class="ph FontProperty emphasis">c;</span> which
is then followed one cycle by <span class="ph FontProperty emphasis">e,</span> at
which time the property should pass. However, as written, the property
allows for both <span class="ph FontProperty emphasis">c</span> and <span class="ph FontProperty emphasis">e</span> to
assert after the second occurrence of <span class="ph FontProperty emphasis">d</span> but
not pass until the third occurrence of <span class="ph FontProperty emphasis">d</span> which
could be sometime after <span class="ph FontProperty emphasis">e</span>.
This is completely unexpected behavior, causing many to assume an
assertion bug has been found. However the behavior is correct because <span class="ph FontProperty emphasis">d[=2]</span> is
equivalent to <span class="ph FontProperty emphasis">(d[*1:$] ##1 d)[*2] ##1 d[*1:$]</span>.
It is the last <span class="ph FontProperty emphasis">d[*1:$]</span> which
keeps a thread from the left-hand side (LHS) of the implication
alive until the third occurrence of <span class="ph FontProperty emphasis">d</span>.
In order for a property with implication to pass, all threads started
from both the LHS and right-hand side (RHS) of the implication must complete.
In this example the threads from the LHS do not complete until signal <span class="ph FontProperty emphasis">d</span> occurs
a third time, even if all threads from the RHS have already completed.
To avoid this behavior the <span class="ph FontProperty emphasis">d[=2] </span>can
be replaced by <span class="ph FontProperty emphasis">d[-&gt;2]</span> to
get the intended behavior.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id1932d798-e3ef-43e6-8704-2ff201bc8cf6"><p class="p">Specify behaviors accurately. Take the
SVA sequence below:</p>
<pre class="pre codeblock"><code>sequence easy;
	always @(posedge clk) a ##1 b ##1 c;
endsequence</code></pre><p class="p">This sequence named <span class="ph FontProperty emphasis">easy</span> appears
to be straight-forward, and it is. It states that <span class="ph FontProperty emphasis">a</span> is
followed by <span class="ph FontProperty emphasis">b</span> which
is followed by <span class="ph FontProperty emphasis">c</span> (all
with delay of a single cycle/clock). However, if the correct behavior
requires <span class="ph FontProperty emphasis">a</span> and <span class="ph FontProperty emphasis">b</span> signals
to either remain asserted or to de-assert in the next cycle, then
this simple sequence will not check for the expected behavior. The following
modifications will:</p>
<pre class="pre codeblock leveled"><code>a ##1 a &amp; b ##1 a &amp; b &amp; c;</code></pre><p class="p">Or, depending on expected behavior:</p>
<pre class="pre codeblock leveled"><code>a ##1 !a &amp; b ##1 !a &amp; ! b &amp; c;</code></pre><p class="p">Another example: If a sequence is needed
that says <span class="ph FontProperty emphasis">a</span> happens
at a clock edge followed by <span class="ph FontProperty emphasis">b</span> in
4 to 8 clock cycles followed by <span class="ph FontProperty emphasis">c</span>,
it can be written as:</p>
<pre class="pre codeblock leveled"><code>sequence s1;
	always @(posedge clk) a ##[4:8]b ##1 c;
endsequence</code></pre><p class="p">This accurately represents the above
requirement. In most cases, however, the requirement is: when <span class="ph FontProperty emphasis">a</span> asserts,
it is to be followed by <span class="ph FontProperty emphasis">b</span> asserting
in 4 to 8 clock cycles; and the first time <span class="ph FontProperty emphasis">b</span> asserts
within the [4:8] cycle range it should be followed by <span class="ph FontProperty emphasis">c</span>.
This is represented by:</p>
<pre class="pre codeblock leveled"><code>sequence s2;
	always @(posedge clk) a ##1 !b[*3:7] ##1 b ##1 c;
endsequence</code></pre><p class="p">The difference between sequences <span class="ph FontProperty emphasis">s1</span> and <span class="ph FontProperty emphasis">s2</span> is
that in <span class="ph FontProperty emphasis">s2</span>, <span class="ph FontProperty emphasis">c</span> has
to follow the first occurrence of <span class="ph FontProperty emphasis">b</span> in
[*4:8] range whereas in <span class="ph FontProperty emphasis">seq1</span>, <span class="ph FontProperty emphasis">c</span> can
follow any occurrence of <span class="ph FontProperty emphasis">b</span> in
[*4:8]. In most cases the requirement is that of <span class="ph FontProperty emphasis">s2</span>.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id64f99310-94b3-4a8a-9b36-e686e6cd4382"><p class="p">This is an example of a badly written
cover sequence:</p>
<pre class="pre codeblock leveled"><code>cover sequence (@(posedge clk)
	dll_state == DL_INACTIVE [*1:$] ##1 dll_state == DL_INIT [*1:$]    ##1 dll_state == DL_ACTIVE);</code></pre><p class="p">A thread will be started at every clock
edge as long as the dll_state is DL_INACTIVE which really makes
no sense. A better way to write this is to use the <span class="ph FontProperty emphasis">cover property</span> statement:</p>
<pre class="pre codeblock leveled"><code>cover property (@(posedge clk)
	$changed(dll_state) |-&gt;
		$past(dll_state == DL_INACTIVE) ##0 dll_state == DL_INIT       [*1:$] ##1 dll_state == DL_ACTIVE;</code></pre></li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__id887abbe3-e9bd-451b-90e9-457176906539"><p class="p">Be careful what you do in an <span class="ph FontProperty emphasis">assertion pass</span> statement.
SV assertions have an action block which contains an <span class="ph FontProperty emphasis">assertion pass</span> statement
as well as an <span class="ph FontProperty emphasis">assertion failure</span> statement.
If an assertion has a pass statement, then the pass statement gets
executed on both real and vacuous passes. Unless you care about
vacuous passes you should use the assert control task <span class="ph FontProperty emphasis">$assertvacuousoff</span> to
turn off executing of pass action blocks for vacuous passes.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idc2303683-3066-4d1c-82d9-b779fa01c5a2"><p class="p">Take into account reset conditions.
You do not want to see false failures due to an assertion failing
because either the design is not yet initialized or that a reset occurs
during operation.</p>
</li>
<li class="li" id="id84398069-0125-4451-8123-6062979ce451__idbee78b50-7849-4648-9447-ae27716a390f"><p class="p">For local var usage please refer to:
www.mentor.com/resources/techpubs/upload/mentorpaper_35466.pdf</p>
</li>
</ol>
</div>
<div class="related-links TopicTOC levels:1">
<ul class="ullinks">
<li class="link ulchildlink"><strong><a href="../topics/Concept_UsingAssertDirectiveNames_id6ee416fe.html" title="PSL 1.1 provides for named directives via the use of a label. You are not allowed to have a label that duplicates another symbol in the same scope. In other words, you cannot explicitly label a PSL directive with a name that already exists (as, say, a signal).">Using Assert Directive Names</a></strong></li>
<li class="link ulchildlink"><strong><a href="../topics/Concept_UsingSystemverilogBindConstruct_idaf84be07.html" title="The SystemVerilog bind construct allows you to bind a Verilog design unit to another Verilog design unit, to a VHDL design unit, or to a SystemC module. This is especially useful for binding SystemVerilog assertions to your VHDL, Verilog, SystemC and mixed designs during verification. ">SystemVerilog Bind Construct</a></strong></li>
</ul>

<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_OverviewAssertionsCoverDirectives_id52585b19.html" title="The use of assertions and cover directives falls into the category of “white box” testing – they specify and validate the expected behavior of a design. Assertions and cover directives are written directly into the design in order to observe the values of signals and states, possibly over a span of time. This allows the verification tool to observe (and log) when particular events occur or assumptions are violated.">Overview of Assertions and Cover Directives</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_user"
                DocTitle = "Questa® SIM User's Manual"
                PageTitle = "Assertion Coding Guidelines"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Contain_AssertionCodingGuidelines_id84398069.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM User's Manual Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>