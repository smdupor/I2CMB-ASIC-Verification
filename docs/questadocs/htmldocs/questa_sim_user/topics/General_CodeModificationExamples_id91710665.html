<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="GeneralRefTopic" />
<meta name="DC.Title" content="Code Modification Examples" />
<meta name="abstract" content="You can modify sc_main in a number of ways, which are demonstrated in the examples in this section." />
<meta name="description" content="You can modify sc_main in a number of ways, which are demonstrated in the examples in this section." />
<meta name="prodname" content="Questa SIM User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM User's Manual" />
<meta name="CSHelp" content="none" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id91710665-1fda-4352-b41c-f7f2a1369d25" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Code Modification Examples</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Code Modification Examples" />
<meta name="attributes" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body class="default" id="id91710665-1fda-4352-b41c-f7f2a1369d25">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Code Modification Examples</h1>
<div class="body refbody GeneralRefBody" id="idbea52553-b0a1-44a5-a951-7c012d0d6e20"><div class="abstract GeneralRefAbstract"><span class="shortdesc">You can
modify sc_main in a number of ways, which are demonstrated in the
examples in this section.</span>
</div>
<div class="section Subsections"><div class="section Subsection" id="id91710665-1fda-4352-b41c-f7f2a1369d25__id56706e79-bf27-44ab-b7b1-0d885473a035"><div class="fig fignone ExampleTitle" id="id91710665-1fda-4352-b41c-f7f2a1369d25__idf6603eb5-e7b3-4b00-be5b-5c38bea16d3f"><span class="figcap"><span class="fig--title-label">Example 1. </span>Converting
sc_main to a Module</span></div>
<p class="p"><a class="xref fm:Table" href="#id91710665-1fda-4352-b41c-f7f2a1369d25__id8bec93d2-624c-4ad6-a26d-b45a2a7eac7a">Table 1</a> shows a simple example of how to convert <span class="ph FontProperty HeadingLabel">sc_main</span> to
a module that you can elaborate with the <span class="ph FontProperty HeadingLabel">vsim</span> command. </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id91710665-1fda-4352-b41c-f7f2a1369d25__id8bec93d2-624c-4ad6-a26d-b45a2a7eac7a" class="table" frame="border" border="1" rules="cols"><caption><span class="tablecap"><span class="table--title-label">Table 1. </span>Simple Conversion: sc_main to Module</span></caption><colgroup><col style="width:2.805in" /><col style="width:3.044in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e173"><p class="p">Original
OSCI code #1 (partial)</p>
</th>
<th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e180"><p class="p">Modified code #1 (partial)</p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e173 "><p class="p">int sc_main(int argc,
char* argv[])</p>
<p class="p">{</p>
<p class="p">sc_signal&lt;bool&gt; mysig;</p>
<p class="p">mymod mod("mod");</p>
<p class="p">mod.outp(mysig);</p>
<p class="p">sc_start(100, SC_NS);</p>
<p class="p">}</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e180 "><p class="p">SC_MODULE(mytop)</p>
<p class="p">{</p>
<p class="p">sc_signal&lt;bool&gt; mysig;</p>
<p class="p">mymod mod;</p>
<p class="p">SC_CTOR(mytop) </p>
<p class="p">: mysig("mysig"),</p>
<p class="p">mod("mod")</p>
<p class="p">{</p>
<p class="p">mod.outp(mysig);</p>
<p class="p">}</p>
<p class="p">};</p>
<p class="p">SC_MODULE_EXPORT(mytop);</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">Here, you would use the following run command
for the modified code as the equivalent to the sc_start(100, SC_NS)
statement in the original OSCI code:</p>
<p class="lines ApplCommand">run 100 ns</p>
<div class="fig fignone ExampleTitle" id="id91710665-1fda-4352-b41c-f7f2a1369d25__idffea077f-f82a-4355-82cd-633ecb7b94cd"><span class="figcap"><span class="fig--title-label">Example 2. </span>Using
sc_main and Signal Assignments</span></div>
<p class="p"><a class="xref fm:Table" href="#id91710665-1fda-4352-b41c-f7f2a1369d25__id82c3ede6-4eb7-4e46-a40b-06906314cc71">Table 2</a> shows a slightly more complex conversion
that illustrates the use of <span class="ph FontProperty HeadingLabel">sc_main()</span> and
signal assignments, and how you would get the same behavior using <span class="ph fmvar:ProductName">Questa SIM</span>.</p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id91710665-1fda-4352-b41c-f7f2a1369d25__id82c3ede6-4eb7-4e46-a40b-06906314cc71" class="table" frame="border" border="1" rules="cols"><caption><span class="tablecap"><span class="table--title-label">Table 2. </span>Using sc_main and Signal Assignments</span></caption><colgroup><col style="width:2.854in" /><col style="width:3.970in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e252"><p class="p">OSCI code #2 (partial)</p>
</th>
<th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e255"><p class="p">Modified code #2 (partial)</p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e252 "><p class="p"><span class="ph FontProperty P9">int sc_main(int, char**)</span></p>
<p class="p"><span class="ph FontProperty P9">{</span></p>
<p class="p"><span class="ph FontProperty P9">sc_signal&lt;bool&gt; reset;</span></p>
<p class="p"><span class="ph FontProperty P9">counter_top top("top");</span></p>
<p class="p"><span class="ph FontProperty P9">sc_clock CLK("CLK", 10, SC_NS,               0.5, 0.0, SC_NS, false);</span></p>
<p class="p"><span class="ph FontProperty P9">top.reset(reset);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(1);</span></p>
<p class="p"><span class="ph FontProperty P9">sc_start(5, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(0);</span></p>
<p class="p"><span class="ph FontProperty P9">sc_start(100, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(1);</span></p>
<p class="p"><span class="ph FontProperty P9">sc_start(5, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(0);</span></p>
<p class="p"><span class="ph FontProperty P9">sc_start(100, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">}</span></p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e255 "><p class="p"><span class="ph FontProperty P9">SC_MODULE(new_top)</span></p>
<p class="p"><span class="ph FontProperty P9">{</span></p>
<p class="p"><span class="ph FontProperty P9">sc_signal&lt;bool&gt; reset;</span></p>
<p class="p"><span class="ph FontProperty P9">counter_top top;</span></p>
<p class="p"><span class="ph FontProperty P9">sc_clock CLK;</span></p>
<p class="p"><span class="ph FontProperty P9">void sc_main_body();</span></p>
<p class="p"><span class="ph FontProperty P9">SC_CTOR(new_top)</span></p>
<p class="p"><span class="ph FontProperty P9">: reset("reset"),</span></p>
<p class="p"><span class="ph FontProperty P9">top("top")</span></p>
<p class="p"><span class="ph FontProperty P9">CLK("CLK", 10, SC_NS, 0.5, 0.0, SC_NS, false)</span></p>
<p class="p"><span class="ph FontProperty P9">{</span></p>
<p class="p"><span class="ph FontProperty P9">top.reset(reset);</span></p>
<p class="p"><span class="ph FontProperty P9">SC_THREAD(sc_main_body);</span></p>
<p class="p"><span class="ph FontProperty P9">}</span></p>
<p class="p"><span class="ph FontProperty P9">};</span></p>
<p class="p"><span class="ph FontProperty P9">void</span></p>
<p class="p"><span class="ph FontProperty P9">new_top::sc_main_body()</span></p>
<p class="p"><span class="ph FontProperty P9">{</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(1);</span></p>
<p class="p"><span class="ph FontProperty P9">wait(5, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(0);</span></p>
<p class="p"><span class="ph FontProperty P9">wait(100, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(1);</span></p>
<p class="p"><span class="ph FontProperty P9">wait(5, SC_NS);</span></p>
<p class="p"><span class="ph FontProperty P9">reset.write(0);</span></p>
<p class="p"><span class="ph FontProperty P9">wait(100, SC_NS);</span></p>
<p class="p">sc_stop();</p>
<p class="p"><span class="ph FontProperty P9">}</span></p>
<p class="p"><span class="ph FontProperty P9">SC_MODULE_EXPORT(new_top);</span></p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="fig fignone ExampleTitle" id="id91710665-1fda-4352-b41c-f7f2a1369d25__id4e47781a-d498-47fd-9283-9ee68ea5d5be"><span class="figcap"><span class="fig--title-label">Example 3. </span>Using
an SCV Transaction Database</span></div>
<p class="p"><a class="xref fm:Table" href="#id91710665-1fda-4352-b41c-f7f2a1369d25__id452abbf2-ba87-4233-ad76-f27a4e7581d6">Table 3</a> shows a conversion that modifies a design
using an SCV transaction database. <span class="ph fmvar:ProductName">Questa SIM</span> requires
that you create the transaction database before calling the constructors
on the design subelements. </p>

<div class="tablenoborder"><table cellpadding="4" cellspacing="0" summary="" id="id91710665-1fda-4352-b41c-f7f2a1369d25__id452abbf2-ba87-4233-ad76-f27a4e7581d6" class="table" frame="border" border="1" rules="cols"><caption><span class="tablecap"><span class="table--title-label">Table 3. </span>Modifications Using SCV Transaction Database</span></caption><colgroup><col style="width:2.925in" /><col style="width:3.574in" /></colgroup><thead class="thead" style="text-align:left;"><tr class="row"><th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e415"><p class="p">Original OSCI code
# 3 (partial)</p>
</th>
<th class="entry cellrowborder default-entry" style="vertical-align:top;" id="d74219e418"><p class="p">Modified <span class="ph fmvar:ProductName">Questa SIM</span> code #3 (partial)</p>
</th>
</tr>
</thead>
<tbody class="tbody"><tr class="row"><td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e415 "><p class="p">int sc_main(int argc,
char* argv[])</p>
<p class="p">{</p>
<p class="p">scv_startup();</p>
<p class="p">scv_tr_text_init();</p>
<p class="p">scv_tr_db db("my_db");</p>
<p class="p">scv_tr_db db::set_default_db(&amp;db);</p>
<p class="p">sc_clock clk ("clk",20,0.5,0,true);</p>
<p class="p">sc_signal&lt;bool&gt; rw;</p>
<p class="p">test t("t");</p>
<p class="p">t.clk(clk);;</p>
<p class="p">t.rw(rw);</p>
<p class="p">sc_start(100);</p>
<p class="p">}</p>
</td>
<td class="entry cellrowborder default-entry" style="vertical-align:top;" headers="d74219e418 "><p class="p">SC_MODULE(top)</p>
<p class="p">{</p>
<p class="p">sc_signal&lt;bool&gt;* rw;</p>
<p class="p">test* t;</p>
<p class="p">SC_CTOR(top)</p>
<p class="p">{</p>
<p class="p">scv_startup();</p>
<p class="p">scv_tr_text_init() </p>
<p class="p">scv_tr_db* db = new scv_tr_db("my_db");</p>
<p class="p">scv_tr_db::set_default_db(db):;</p>
<p class="p">clk = new sc_clock("clk",20,0.5,0,true);</p>
<p class="p">rw = new sc_signal&lt;bool&gt; ("rw");</p>
<p class="p">t = new test("t");</p>
<p class="p">}</p>
<p class="p">};</p>
<p class="p">SC_MODULE_EXPORT(new_top);</p>
</td>
</tr>
</tbody>
</table>
</div>
<p class="p">Take care to preserve the order of functions
called in <span class="ph FontProperty HeadingLabel">sc_main()</span> of
the original code. </p>
<p class="p">You cannot place subelements in the initializer
list, since the constructor body must be executed prior to their
construction. Therefore, you must make the subelements as pointer
types by creating them with "new" in the SC_CTOR() module. </p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/MGCChap_SystemcSimulation_id0a80723e.html" title="This chapter describes how to compile and simulate SystemC designs with the Questa SIM simulator. The simulator implements the SystemC language based on the Open SystemC Initiative (OSCI) proof-of-concept SystemC simulator. The default supported version of SystemC is the IEEE 1666-2011 standard, SystemC-2.3.2. Release 2.3.2 of SystemC includes Release 2.0.3 of Transaction Level Modeling (TLM) code. It is recommended that you obtain the OSCI functional specification or the latest version of the IEEE Std 1666-2011, IEEE Standard SystemC Language Reference Manual.">SystemC Simulation</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_user"
                DocTitle = "Questa® SIM User's Manual"
                PageTitle = "Code Modification Examples"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/General_CodeModificationExamples_id91710665.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM User's Manual Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>