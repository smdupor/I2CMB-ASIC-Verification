<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2020" />
<meta name="DC.rights.owner" content="(C) Copyright 2020" />
<meta name="DC.Type" content="ConceptTopic" />
<meta name="DC.Title" content="Errors During Loading" />
<meta name="abstract" content="When simulating your SystemC design, you might get a “failed to load sc lib” message because of an undefined symbol, looking something like this:" />
<meta name="description" content="When simulating your SystemC design, you might get a “failed to load sc lib” message because of an undefined symbol, looking something like this:" />
<meta name="DC.subject" content="errors, SystemC loading" />
<meta name="keywords" content="errors, SystemC loading" />
<meta name="prodname" content="Questa SIM User's Manual" />
<meta name="version" content="2014.06" />
<meta name="release" content="v2014.06" />
<meta name="series" content="mgc_ih" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Creator" content="Mentor Graphics Corporation" />
<meta name="DC.Publisher" content="Mentor Graphics Corporation 10 24 2014 10 24 2014 Fresh off the boat." />
<meta name="DC.Date.Created" content="0000-00-00" />
<meta name="DC.Date.Modified" content="2020-03-05" />
<meta name="VariantPrefix" content="Q" />
<meta name="Tier" content="1" />
<meta name="SubTitle" content="Including Support for Questa SV/AFV" />
<meta name="SourceHandle" content="questa_sim_user" />
<meta name="SoftwareVersionNum" content="2020.4" />
<meta name="SoftwareRelease" content="none" />
<meta name="RevHist" content="5.3" />
<meta name="PublicationDate" content="none" />
<meta name="Platform" content="none" />
<meta name="PartNumber" content="none" />
<meta name="LicenseType" content="EULA" />
<meta name="InfoHubHandle" content="questa_sim_ih" />
<meta name="EclipsePluginName" content="none" />
<meta name="DraftDate" content="none" />
<meta name="Draft" content="none" />
<meta name="DocumentTitle" content="Questa® SIM User's Manual" />
<meta name="CSHelp" content="none" />
<meta name="CSDSearchKeywords" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="Copyright" content="READONLY - Use: copyrfirst and copyrlast" />
<meta name="ConditionFiltering" content="XML" />
<meta name="ChecklinksRelease" content="mti2020" />
<meta name="BookcaseHandle" content="_bk_questa_sim" />
<meta name="Beta" content="none" />
<meta name="Alpha" content="none" />
<meta name="ActiveStatus" content="Active" />
<meta name="GenerateOnlyChangedTopics" content="none" />
<meta name="HighlightChanges" content="none" />
<meta name="HighlightColor" content="Pale Green" />
<meta name="IncludeInInventory" content="yes" />
<meta name="SourceEDDVersion" content="12.2.10" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="id1f35ae16-be50-4888-98c5-a8267441f74d" />
<link rel="stylesheet" type="text/css" href="../commonltr.css" />
<title>Errors During Loading</title>
<link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /><noscript><link rel="StyleSheet" href="../../MGC/styles/body.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/catalog.css" type="text/css" /><link rel="StyleSheet" href="../../MGC/styles/document.css" type="text/css" /><link rel="stylesheet" href="../../MGC/styles/mgcdita-lang.css" type="text/css" /></noscript><meta name="mgc_html_doctitle" content="Errors During Loading" />
<meta name="attributes" content="product.version.2020.4,sort.order.020,doc.type.documentation.user,product.id.P10593,product.id.P11633,product.id.P11632," />
<meta name="TEMPLATEBASE" content="mgc_mgchelp_v4.2.009" />
<script type="text/javascript" language="JavaScript1.2" src="../../MGC/js/page.js"></script><script type="text/javascript" language="JavaScript1.2">
            if(DetectChromeForBasic()){
            writeNoScriptStyles();
            }

        </script><script type="text/javascript" language="JavaScript1.2">
            // Set reference to top level help frame
            //
            if(!DetectChromeForBasic()){
            javascriptTopicRedirect();
            }
        </script></head>
<body id="id1f35ae16-be50-4888-98c5-a8267441f74d">
<div id="bodycontent" class="BodyContent">
<script type="text/javascript" language="JavaScript1.2">
              var BC = new Array("TODO: Breadcrumb Title","title1","naV","naV","naV","naV","2");
          </script>
<noscript><iframe framespacing="0" marginheight="2px" frameborder="no" scrolling="no" src="../../MGC/html/noscript_header.htm" width="100%" height="100px;">xxx</iframe></noscript>
<script type="text/javascript" language="JavaScript1.2">
              if(DetectChromeForBasic()){
              if(!(top.inEclipse)){
              writeBasicHeader();
              }
              }
          </script>
<div id="BodyContent"><h1 class="title topictitle1">Errors
During Loading</h1>
<div class="body conbody ConceptBody"><div class="abstract ConceptAbstract"><span class="shortdesc">When simulating
your SystemC design, you might get a “failed to load sc lib” message
because of an undefined symbol, looking something like this:</span>
</div>
<pre class="pre codeblock leveled"><code># Loading /home/cmg/newport2_systemc/chip/vhdl/work/systemc.so</code></pre><pre class="pre codeblock leveled"><code># ** Error: (vsim-3197) Load of "/home/cmg/newport2_systemc/chip/vhdl/work/systemc.so" failed: ld.so.1:</code></pre><pre class="pre codeblock leveled"><code>/home/icds_nut/modelsim/5.8a/sunos5/vsimk: fatal: relocation error: file</code></pre><pre class="pre codeblock leveled"><code>/home/cmg/newport2_systemc/chip/vhdl/work/systemc.so: symbol _Z28host_respond_to_vhdl_requestPm:</code></pre><pre class="pre codeblock leveled"><code>referenced symbol not found.</code></pre><pre class="pre codeblock leveled"><code># ** Error: (vsim-3676) Could not load shared library /home/cmg/newport2_systemc/chip/vhdl/work/systemc.so for SystemC module 'host_xtor'.</code></pre><div class="section Subsections"><div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id94227550-228a-411a-9517-2b5e0540ea99"><h2 class="title Subheading sectiontitle">Source of Undefined Symbol Message</h2><p class="p">The causes for an error such as “failed to load
sc lib” could be many.</p>
<p class="p">The reasons include:</p>
<ul class="ul"><li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id699f53d7-cc5d-40cd-9414-732a77960540"><p class="p">missing definition of a function/variable</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id1ffdd71b-9702-45d8-b413-6526bdc8a459"><p class="p">missing type</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id992df8fe-8c5e-4842-a39f-6e7e99e5a681"><p class="p">object file or library containing the
defined symbol is not linked</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id75038cf9-02f1-428a-9adc-3a2079699471"><p class="p">mixing of C and C++ compilers to compile
a testcase</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id5b59f8ea-0313-45a4-9a16-0e99ed88c444"><p class="p">using SystemC header files from other
vendors</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__idc25e1a31-2e71-48a1-a787-842618ca7267"><p class="p">bad link order specified in sccom -link</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id23fe5549-98f9-4161-aaf2-3c6d1964ec91"><p class="p">multiply-defined symbols</p>
</li>
</ul>
</div>
<div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id96fd1c5c-a6c2-4f81-add3-0d36cd223828"><h2 class="title Subheading sectiontitle">Missing Definition</h2><p class="p">If the undefined symbol is a C function in
your code or a library you are linking with, be sure that you declared
it as an extern C function:</p>
<pre class="pre codeblock leveled"><code>extern "C" void myFunc();</code></pre><p class="p">This should appear in any header files include
in your C++ sources compiled by sccom. It tells the compiler to
expect a regular C function; otherwise the compiler decorates the
name for C++ and then the symbol cannot be found.</p>
<p class="p">Also, be sure that you actually linked with
an object file that fully defines the symbol. You can use the nm
utility on Linux platforms to test your SystemC object files and
any libraries you link with your SystemC sources. For example, assume
you ran the following commands:</p>
<p class="lines ApplCommand">sccom test.cpp<br />
sccom -link libSupport.a</p>
<p class="p">If there is an unresolved symbol and it is
not defined in your sources, it should be correctly defined in any
linked libraries:</p>
<p class="lines ApplCommand">nm libSupport.a | grep "mySymbol"</p>
</div>
<div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id87939549-6ee8-4594-b1de-2b00db9ade2c"><h2 class="title Subheading sectiontitle">Missing Type</h2><p class="p">When you get errors during design elaboration,
be sure that all the items in your SystemC design hierarchy, including
parent elements, are declared in the declarative region of a module. If
not, sccom ignores them. </p>
<p class="p">For example, consider a design containing SystemC
over VHDL. The following declaration of a child module test inside
the constructor module of the code is not allowed and will produce
an error:</p>
<pre class="pre codeblock leveled"><code>SC_MODULE(Export)
{
	SC_CTOR(Export)
	{
		test *testInst;
		testInst = new test("test");
	}
};
</code></pre><p class="p">The error results from the fact that the SystemC
parse operation will not see any of the children of test. Nor will
any debug information be attached to it. Thus, the signal has no
type information and cannot be bound to the VHDL port.</p>
<p class="p">The solution is to move the element declaration
into the declarative region of the module.</p>
</div>
<div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id975c8a88-581b-40fe-a655-f78f96663986"><h2 class="title Subheading sectiontitle">Using SystemC
Header Files Supplied by Other Vendors</h2><p class="p">Both SystemC 2.3.2 and SystemC 2.2 include
version control for SystemC header files. If you compile your SystemC
design using a SystemC header file that was distributed by other vendors,
and then you run sccom -link to link the design, an error similar
to the following may result upon loading the design:</p>
<pre class="pre codeblock leveled"><code>** Error: (vsim-3197) Load of "work/systemc.so" failed: work/systemc.so: undefined symbol: _ZN20sc_api_version_2_1_0C1Ev.</code></pre><p class="p">To
resolve the error, recompile the design using <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'sccom', 'questa_sim_ref'); return false;">sccom</a>.
Make sure any include paths read by sccom do not point to a SystemC 2.2
or 2.3.2 installation. By default, sccom automatically picks up
the <span class="ph fmvar:ProductName">Questa SIM</span> SystemC
header files.</p>
</div>
<div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id6d0bc4ec-96f4-4a04-9ac3-27adfb3a6d80"><h2 class="title Subheading sectiontitle">Misplaced
-link Option</h2><p class="p">The order in which you place the -link option
within the sccom -link command is critical. There is a big difference
between the following two commands:</p>
<p class="lines ApplCommand">sccom -link liblocal.a </p>
<p class="p">and</p>
<p class="lines ApplCommand">sccom liblocal.a -link</p>
<p class="p">The first command ensures that your SystemC
object files are seen by the linker before the library <span class="ph filepath">liblocal.a</span> and
the second command ensures that <span class="ph filepath">liblocal.a</span> is
seen first. Some linkers can look for undefined symbols in libraries
that follow the undefined reference while others can look both ways.
For more information on command syntax and dependencies, see <a class="xref Link" href="../../questa_sim_ref/nsmgchelp.htm" target="_top" onclick="oT('STD_FM11', 'sccom', 'questa_sim_ref'); return false;">sccom</a>.</p>
</div>
<div class="section Subsection" id="id1f35ae16-be50-4888-98c5-a8267441f74d__ide5d4edfe-5fc2-428f-98fd-8df18a0d8a8c"><h2 class="title Subheading sectiontitle">Multiple
Symbol Definitions</h2><p class="p">The most common type of error found during
sccom -link operation is the multiple symbol definition error. The
error message looks something like this:</p>
<pre class="pre codeblock leveled"><code>work/sc/gensrc/test_ringbuf.o: In function `test_ringbuf::clock_generator(void)':</code></pre><pre class="pre codeblock leveled"><code>work/sc/gensrc/test_ringbuf.o(.text+0x4): multiple definition of `test_ringbuf::clock_generator(void)'</code></pre><pre class="pre codeblock leveled"><code>work/sc/test_ringbuf.o(.text+0x4): first defined here
</code></pre><p class="p">This
error arises when the same global symbol is present in more than one <span class="ph filepath">.o</span> file.
There are two common causes of this problem:</p>
<ul class="ul"><li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id3527c5ed-2e2a-490f-962b-c74bc1a12fed"><p class="p">A stale <span class="ph filepath">.o</span> file
in the working directory with conflicting symbol names.</p>
<p class="p">In this first case, just remove the stale
files with the following command:</p>
<p class="lines ApplCommand">   vdel -lib &lt;lib_path&gt; -allsystemc</p>
</li>
<li class="li" id="id1f35ae16-be50-4888-98c5-a8267441f74d__id65ea8481-4d28-4224-b384-f688f8f0a535"><p class="p">Incorrect definition of symbols in header
files. </p>
</li>
</ul>
<p class="p">In the second case, if you have an out-of-line
function (one that is not preceded by the inline keyword) or a variable
defined (for instance, not just referenced or prototyped, but truly defined)
in a <span class="ph filepath">.h</span> file, you cannot include that <span class="ph filepath">.h</span> file
in more than one <span class="ph filepath">.cpp</span> file. </p>
<p class="p">Text in <span class="ph filepath">.h</span> files is included
into <span class="ph filepath">.cpp </span>files by the C++ preprocessor. By
the time the compiler sees the text, it is just as if you had typed
the entire text from the <span class="ph filepath">.h</span> file into the <span class="ph filepath">.cpp</span> file.
So an <span class="ph filepath">.h</span> file included into two <span class="ph filepath">.cpp</span> files
results in lots of duplicate text being processed by the C++ compiler
when it starts up. Include guards are a common technique to avoid
duplicate text problems.</p>
<p class="p">If an <span class="ph filepath">.h</span> file has an out-of-line
function defined, and that <span class="ph filepath">.h</span> file is included
into two <span class="ph filepath">.c</span> files, then the out-of-line function
symbol will be defined in the two corresponding <span class="ph filepath">.o</span> files.
This leads to a multiple symbol definition error during sccom -link. </p>
<p class="p">To
solve this problem, add the inline keyword to give the function internal
linkage. This makes the function internal to the<span class="ph filepath">.o</span> file,
and prevents the function's symbol from colliding with a symbol
in another <span class="ph filepath">.o </span>file.</p>
<p class="p">For free functions or variables, you could
modify the function definition by adding the static keyword instead
of inline, although inline is better for efficiency. </p>
<p class="p">Sometimes compilers do not honor the "inline"
keyword. In such cases, you should move your function(s) from a
header file into an out-of-line implementation in a <span class="ph filepath">.cpp</span> file. </p>
</div>
</div>
</div>
<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent Topic:</strong> <a class="link" href="../topics/Contain_TroubleshootingSystemcErrors_id72ff1161.html" title="In the process of modifying your SystemC design to run on Questa SIM, you may encounter several common errors. This section highlights some actions you can take to correct such errors.">Troubleshooting SystemC Errors</a></div>
</div>
</div></div>
</div>
<!--BeginFooterContent--><div class="BlankFooter" id="BlankFooter"> </div><div class="Footer" id="Footer"> </div><script type="text/javascript"><!--
                PDFLinkTitle = "InfoHub.Help"
                DocHandle = "questa_sim_user"
                DocTitle = "Questa® SIM User's Manual"
                PageTitle = "Errors During Loading"
                Copyright = "2020"
                ThisTopic = "PointingtoaCommoncustomerjsFile";
                CurrentFile = "topics/Concept_ErrorsDuringLoading_id1f35ae16.html"
                CurrentFileID = "3";
                topicFooter();
            --></script><noscript><p class="MGCFooter">Questa® SIM User's Manual Software Version 2020.4<br />Unpublished work. © Siemens 2020<br /><a href="../../mgc_html_help/nsmgchelp.htm" target="_blank">Browser Requirements</a></p></noscript></body>
</html>